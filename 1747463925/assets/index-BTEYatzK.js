import{j as e,r as u}from"./index-BpkY95s5.js";import{d as s}from"./index-CsSXPTiX.js";import{l as c,i as h,s as j}from"./index-Dtau3K64.js";import{a8 as y,an as d,D as L,ao as v,T as p}from"./CommonWrapper-CyS6O-ZL.js";import{W as k,F as g}from"./index-hAHZ4tuw.js";import{R as x,a as w}from"./index-CaOY7x2m.js";import{M as C}from"./Menu-DnBteei9.js";import"./methods-DjtwcIIC.js";import"./index-CaTv_tDC.js";import"./uploadUtil-D9ILcUvY.js";import"./index-B8fWkc5R.js";const m=s(({store:r})=>{const{localStore:i,stepStore:a,collageInfo:o}=r;return e.jsx(p,{stepStore:a,localStore:i,polygonStore:null,menu:e.jsx(C,{collageInfo:o,localStore:i,stepStore:a,layerImageCreate:()=>Promise.resolve()})})}),f=s(({shuffleImg:r,store:i})=>{const{localStore:a,stepStore:o}=i;u.useEffect(()=>{i.page.width=800,i.page.height=1200,i.page.backgroundLayer.extra.backgroundColor="#ffffff",i.initialized=!0},[]);function n(l){switch(l){case 0:return null;case 1:return e.jsx(v,{localStore:a,frameList:i.savedState.posterCollageInfo.pageList,overlay:e.jsx(p,{localStore:a,stepStore:o,polygonStore:null,menu:null})});case 2:return e.jsx(L,{localStore:a,className:"",children:e.jsx(d,{localStore:a,toolsContainer:e.jsx(m,{store:i}),watermarkView:null})});case 3:return e.jsx(k,{localStore:a,navigator:e.jsx(d,{localStore:a,toolsContainer:null,watermarkView:null}),shuffleImg:r,addOrReplacePanelImageToPage:t=>{w(i,a,t)},children:e.jsx(d,{localStore:a,toolsContainer:e.jsx(m,{store:i}),watermarkView:null})});default:return null}}return e.jsx(y,{style:{position:"relative",width:"100%",height:"100%"},localStore:a,stepStore:o,polygonStore:null,children:n(2)})}),I=s(({store:r})=>{const{localStore:i,stepStore:a,collageInfo:o}=r,n=()=>{if(r.imageLayerList.length<2)return;const l=c.shuffle(c.cloneDeep(r.imageLayerList));if(l[0].id===r.imageLayerList[0].id){const t=l.splice(0,1);l.push(t[0])}for(const t in l)r.imageLayerList[t]&&(r.imageLayerList[t].image=l[t].image,r.imageLayerList[t].extra.backgroundColor=l[t].extra.backgroundColor,h(r.imageLayerList[t]),j(i,r.imageLayerList[t]))};return e.jsxs("div",{style:{height:"100%",backgroundColor:"var(--background--main)",display:"flex"},children:[e.jsx("div",{style:{position:"fixed",right:0,top:0,zIndex:1e3},children:e.jsx(x,{localStore:i,stepStore:a,collageInfo:o})}),e.jsx("div",{style:{flexShrink:0},children:e.jsx(g,{type:"left",foldChanged:()=>{},children:e.jsx("div",{})})}),e.jsx("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:e.jsx(f,{shuffleImg:n,store:r})}),e.jsx("div",{style:{height:"100%",flexShrink:0},children:e.jsx(g,{type:"right",foldChanged:()=>{},children:e.jsx("div",{})})})]})}),F=s(({posterStore:r})=>{const{localStore:i,collageInfo:a,stepStore:o}=r;return i.isMobile?e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[e.jsx(f,{shuffleImg:()=>{},store:r}),e.jsx("div",{style:{position:"fixed",right:0,top:0,zIndex:1e3},children:e.jsx(x,{localStore:i,stepStore:o,collageInfo:a})})]}):e.jsx(I,{store:r})});export{F as default};
