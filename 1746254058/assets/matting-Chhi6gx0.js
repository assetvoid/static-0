import{r as X,j as n,c as Ut}from"./index-BpkY95s5.js";import{d as A,c as wa,m as ba,r as Be,o as V,a as N,b as be}from"./index-CsSXPTiX.js";import{k as ue,m as We,t as Ca,n as La,o as Ke,q as Wt,S as ct,r as Ot,j as $,a as pe,v as Ta,w as ka,l as Q,x as Da,y as mt,z as ja,A as Ia,C as Aa,b as Ra,g as Ea,B as _a,L as Fa,D as Ba}from"./index-Bf7wvBDA.js";import{g as Ha,e as Pa,a as za,b as Ma,c as ut,s as rt,d as Na,O as Ne,f as ot,m as Ua,r as Wa,h as Oa,C as ne,L as Vt,I as Je,i as Va,T as Gt,E as Ga,W as vt}from"./CommonWrapper-CBy7d9at.js";import{c as Xt,a as Xa,t as $t,b as Yt,u as $a}from"./uploadUtil-CgOleq4E.js";import{c as Le}from"./commonUtil-CJSUu6DK.js";import{C as je,g as Ya}from"./index-CUeMkOcO.js";import{T as ae,B as Za}from"./index-DFFAZfDR.js";import{Render as qa}from"./index-DlbzGLht.js";import{p as Qa}from"./index-BKNjMPK8.js";import"./methods-BkHYA0OL.js";import"./textImage-D5OPrFaA.js";function Ka(e,a,i,r){const o=e.getPointInPage(r),t=Ha(e,a,r);Pa(t,{left:0,top:0,width:a.width,height:a.height}),t.x,t.y,o.x,o.y,i.left=o.x,i.top=o.y,i.width=0,i.height=0,i.rotate=a.rotate,e.currentStatus="drawingRect",ue(e,r)}function yt(e,a,i){a.image&&(i==="horizontally"&&(a.image.flipH=!a.image.flipH),i==="vertically"&&(a.image.flipV=!a.image.flipV)),a.nodeType==="IMAGE"&&a.extra.rectList&&a.extra.rectList.forEach(r=>{Ja(e,r,a,i)})}function Ja(e,a,i,r){const o=za(e,i,We(a)),t={x:i.width/2,y:i.height/2};r==="horizontally"&&(o.x=2*t.x-o.x),r==="vertically"&&(o.y=2*t.y-o.y);const c=Ma({localStore:e,pointInLayer:o,layer:i});a.left=c.x-a.width/2,a.top=c.y-a.height/2}function ei(e){return X.useState(e)[0]}const Re={login:"立即登录",logout:"退出登录",loginShowRemainQuantity:"登录查看剩余下载张数",purchaseQuantity:"购买张数",feedback:"意见反馈",remainQuantity:"剩余下载张数: "},ti=Re,ai=Re,ii=Re,ni=Re;function ri({getReactiveLang:e}){return Xt({resourceMap:{cn:Re,jp:ii,tw:ti,kr:ni,en:ai},getReactiveLang:e})}const Ee={appName:"",uploadBtn:"上传图片",originalImage:"原图",preview:"预览",warnTip:"此操作将清空所有操作记录，确定离开此页吗？",waitingResult:"返回结果中",feedback:"意见反馈",removeWatermark:"移除水印",loading:"加载中",modal:{tipTitle:"提示",cancel:"取消",confirm:"确认"},uploadImageSection:{uploadBtn:"上传图片",uploadTip:"拖拽图片&粘贴图片&粘贴图片URL至此处",supportFormart:"支持JPG、JPEG、PNG、HEIC",imageUploading:"图片上传中",imageMatting:"智能抠图中",cancel:"取消"},mattingRightPanel:{backgroundSetting:{color:"颜色",image:"图片",removeBg:"移除背景",oftenUse:"常用",bgUseFaild:"背景应用失败",up:"收起",more:"更多",materialLoading:"素材加载中...",solid:"纯色",linear:"渐变",defaultSolid:"纯色预设",defaultLinear:"渐变预设"},mattingLayerSetting:{originalSize:"原尺寸",free:"自由裁剪",cutoutEdge:"裁剪到边缘",width:"宽",height:"高",scaleImage:"图片缩放",rotateImage:"图片旋转",cancel:"取消",apply:"应用"},filterList:{filterUseFaild:"滤镜应用失败",level:"程度",oftenFilter:"常用滤镜",showMore:"查看更多",removeFilter:"移除滤镜"},edgeSetting:{shadow:"投影",blur:"模糊",distance:"距离",angle:"角度",strokes:"描边",size:"大小",style:"样式",edgeSoftening:"边缘羽化",outerGlow:"外发光",range:"范围"}},toolSection:{identify:"自动识别",areaDelete:"去除",areaAdd:"保留",stroke:"手动修补",returnMatting:"返回抠图",background:"背景",size:"尺寸",edge:"边缘",filter:"滤镜",close:"关闭",pet:"人像宠物",product:"商品货物",logo:"图标印章",eraser:"擦除",swipe:"涂抹",size2:"大小",hardness:"画笔硬度"},headerSection:{preStep:"上一步",nextStep:"下一步",reset:"重置",reupload:"重新上传",resetWarnTip:"重置将会清空当前图片的操作记录，确定重置？"},downloadBtn:{getRemainCountText(e,a){return`本次预计扣除${e}张，剩余${a}张`},downloadNow:"立即下载",unwatermarkedDownload:"",purchase:"",dowbload:"下载",uncompression:"无压缩，",aboutText:"约",fileSize:"请填写文件大小",downladFaild:"下载失败，请重试",customSize:"自定义大小",inputSize:"输入限定大小",kb:"KB內",mb:"MB內",loading:"下载中..."},pageController:{mouse:"抓手",reduce:"缩小",blowUp:"放大",screen:"适应屏幕",realSize:"实际大小"},gradeModal:{effectSatisfaction:"效果满意度",noWarn:"不再提醒",dissatisfied:"不满意",normal:"一般",satisfied:"满意"},feedScroller:{loading:"加载中",noMore:"没有更多了",noData:"暂无数据"}},oi=Ee,li=Ee,si=Ee,di=Ee;function ci({getReactiveLang:e}){return Xt({resourceMap:{cn:Ee,en:oi,jp:li,kr:si,tw:di},getReactiveLang:e})}class ui{constructor(a){this.imageMattingText=ci({getReactiveLang:a.getReactiveLang}),this.uploadText=Xa({getReactiveLang:a.getReactiveLang}),this.userText=ri({getReactiveLang:a.getReactiveLang})}}function gi(e,a){const i=document.createElement("canvas");return i.width=e,i.height=a,i}const hi=`
        precision highp float;
        attribute vec4 position;
        attribute vec4 inputTextureCoordinate;
        varying vec2 textureCoordinate;

        void main() {
            gl_Position = position;
            textureCoordinate = vec2((position.x+1.0)/2.0, 1.0-(position.y+1.0)/2.0);
        }
    `,fi=`
         precision highp float;
         uniform sampler2D texture;
         uniform sampler2D maskTexture;
         uniform sampler2D blurred_alpha;
         uniform sampler2D blurred_FA;
         uniform sampler2D blurred_B1A;
         varying vec2 textureCoordinate;

         void main()
         {
              vec4 srcImage = texture2D(texture, textureCoordinate);
              vec4 maskImage = texture2D(maskTexture, textureCoordinate);

              float alpha = maskImage.a;
              float blurredAlpha = texture2D(blurred_alpha, textureCoordinate).a;
            //   vec3 blurredFA = texture2D(blurred_FA, textureCoordinate).rgb;
              vec4 blurredFALoad = texture2D(blurred_FA, textureCoordinate);
              vec3 blurredFA = blurredFALoad.rgb;//srcImage.rgb * blurredFALoad.a;

              vec3 blurredF = blurredFA / (blurredAlpha + 0.0001);

              vec4 blurredB1ALoad = texture2D(blurred_B1A, textureCoordinate); 
            //   vec3 blurredB1A = blurredB1ALoad.rgb * blurredB1ALoad.a * (1.0-blurredAlpha);
            vec3 blurredB1A = blurredB1ALoad.rgb;//srcImage.rgb * (1.0-blurredAlpha);

            //   vec3 blurredB1A = texture2D(blurred_B1A, textureCoordinate).rgb;
            //   vec3 blurredB = blurredB1A / (1.0 - blurredAlpha + 0.0001);
            vec3 blurredB = blurredB1A * blurredB1ALoad.a / (1.0 - blurredAlpha + 0.0001);
              vec3 tmp = srcImage.rgb + blurredF * (-alpha) + blurredB * (alpha-1.0);
              vec3 fore = blurredF + tmp * (alpha);

              gl_FragColor = vec4(fore * srcImage.a * maskImage.a, srcImage.a * maskImage.a);
         }
    `,pi=`
    precision mediump float;
    varying vec2 textureCoordinate;
    uniform sampler2D texture;
    uniform float textureWidth;
    uniform float textureHeight;
    uniform float size;
    const int  radius = 8;
    // const int kernelSize = 40;
    void main()
    {        
        
        vec4 sum            = vec4(0.0);
        vec4 result         = vec4(0.0);
        vec2 unit_uv        = vec2(size / textureWidth,size / textureHeight)*1.0;
        vec4 curColor       = texture2D(texture, textureCoordinate);

        vec4 centerPixel    = curColor;
        
        float sum_weight    = 1.0;
        //horizontal
        for(int i=-radius;i<=radius;i++)
        {
            vec2 curRightCoordinate = textureCoordinate+vec2(float(i),0.0)*unit_uv;
            vec2 curLeftCoordinate  = textureCoordinate+vec2(float(i),0.0)*unit_uv;
            sum += texture2D(texture,curRightCoordinate);
            sum += texture2D(texture,curLeftCoordinate);
            sum_weight+=2.0;
        }
        
        result = (sum+centerPixel)/sum_weight;
        
        gl_FragColor = result;
    }
`,mi=`
    precision mediump float;
    varying vec2 textureCoordinate;
    uniform sampler2D texture;
    uniform float textureWidth;
    uniform float textureHeight;
    const int  radius = 8;
    uniform float size;

    void main()
    { 
        vec4 sum            = vec4(0.0);
        vec4 result         = vec4(0.0);
        vec2 unit_uv        = vec2(size / textureWidth,size / textureHeight)*1.0;
        vec4 centerPixel    = texture2D(texture, textureCoordinate);
        float  sum_weight   = 1.0;
        
        //vertical
        for(int i=-radius;i<=radius;i++)
        {
            vec2 curBottomCoordinate    = textureCoordinate+vec2(0.0,float(i))*unit_uv;
            vec2 curTopCoordinate       = textureCoordinate+vec2(0.0,float(i))*unit_uv;
            sum+=texture2D(texture,curBottomCoordinate);
            sum+=texture2D(texture,curTopCoordinate);
            sum_weight+=2.0;
        }
        
        result = (sum+centerPixel)/sum_weight;
        
        gl_FragColor = result;
    }
`,vi=`
    precision mediump float;
    uniform sampler2D texture1;
    uniform sampler2D texture2;
    uniform int type;
    varying vec2 textureCoordinate;

    vec4 avgBlurWithMul(sampler2D tex, sampler2D factorTex, bool oneMinusFactor)
    {
        float coefficient = 1.0;
        vec4 avgValue = vec4(0.0);
        vec4 coefficientSum = vec4(0);
        
                float factor = texture2D(factorTex, textureCoordinate).a;
                if (oneMinusFactor) {
                    factor = 1.0 - factor;
                }
                vec4 mergeFacotr = vec4(factor);
                avgValue += texture2D(tex, textureCoordinate) * mergeFacotr * coefficient;
                coefficientSum += coefficient;
       
        return avgValue / coefficientSum;
    }

    void main()
    {   
        vec4 color1 = texture2D(texture1, textureCoordinate);
        vec4 color2 = texture2D(texture2, textureCoordinate);
        // if (type == 1) {
        //     gl_FragColor = avgBlurWithMul(texture1, texture2, false);//color1 * color2;
        // } else if (type == 2) {
        //     // todo:
        //     // gl_FragColor = color1 / color2;
        // } else if (type == 3) {
        //     gl_FragColor = avgBlurWithMul(texture1, texture2, true);//color1 * (vec4(1.0)-color2);
        // }  
        
        if (type == 1) {
            gl_FragColor = mix(vec4(0.0,0.0,0.0,1.0), color1, color2.a);//avgBlurWithMul(texture1, texture2, false);//color1 * color2;
        } else if (type == 2) {
            // todo:
            // gl_FragColor = color1 / color2;
        } else if (type == 3) {
            gl_FragColor = mix(vec4(0.0,0.0,0.0,1.0), color1, 1.0-color2.a);//avgBlurWithMul(texture1, texture2, true);//color1 * (vec4(1.0)-color2);
        }  
    }
`;function Te(e,a,i){const r=e.createShader(a);if(e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;console.log(e.getShaderInfoLog(r)),e.deleteShader(r)}function He(e,a,i){const r=e.createProgram();if(e.attachShader(r,a),e.attachShader(r,i),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;console.error(e.getProgramInfoLog(r)),e.deleteProgram(r)}function ee(e,a){const i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i}const yi=[1,1,1,-1,-1,1,-1,-1];async function ce(e){return new Promise((a,i)=>{const r=new Image;r.src=e.toDataURL("image/png"),r.onload=()=>{a(r)}})}async function Si(e,a,i,r){const o=gi(e,a),t=o.getContext("webgl");if(t==null)return null;t.viewport(0,0,e,a);const m=Math.min(e,a)/501*1.1,v=Te(t,t.VERTEX_SHADER,hi),w=Te(t,t.FRAGMENT_SHADER,pi),k=Te(t,t.FRAGMENT_SHADER,mi),I=Te(t,t.FRAGMENT_SHADER,vi),D=Te(t,t.FRAGMENT_SHADER,fi),T=He(t,v,w),E=He(t,v,k),z=He(t,v,I),B=He(t,v,D),l=ee(t,i),u=ee(t,r),h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array(yi),t.STATIC_DRAW),t.useProgram(T),t.enableVertexAttribArray(t.getAttribLocation(T,"position")),t.vertexAttribPointer(t.getAttribLocation(T,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(t.getUniformLocation(T,"texture"),0),t.uniform1fv(t.getUniformLocation(T,"textureWidth"),[e]),t.uniform1fv(t.getUniformLocation(T,"textureHeight"),[a]),t.uniform1fv(t.getUniformLocation(T,"size"),[m]),t.drawArrays(t.TRIANGLE_STRIP,0,4);let f=await ce(o),p=ee(t,f);t.useProgram(E),t.enableVertexAttribArray(t.getAttribLocation(E,"position")),t.vertexAttribPointer(t.getAttribLocation(E,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,p),t.uniform1i(t.getUniformLocation(E,"texture"),0),t.uniform1fv(t.getUniformLocation(E,"textureWidth"),[e]),t.uniform1fv(t.getUniformLocation(E,"textureHeight"),[a]),t.uniform1fv(t.getUniformLocation(E,"size"),[m]),t.drawArrays(t.TRIANGLE_STRIP,0,4);const H=await ce(o),L=ee(t,H);t.deleteTexture(p),t.useProgram(z),t.enableVertexAttribArray(t.getAttribLocation(z,"position")),t.vertexAttribPointer(t.getAttribLocation(z,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,l),t.uniform1i(t.getUniformLocation(z,"texture1"),0),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(t.getUniformLocation(z,"texture2"),1),t.uniform1iv(t.getUniformLocation(z,"type"),[1]),t.drawArrays(t.TRIANGLE_STRIP,0,4);let O=await ce(o),ie=ee(t,O);t.useProgram(T),t.enableVertexAttribArray(t.getAttribLocation(T,"position")),t.vertexAttribPointer(t.getAttribLocation(T,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,ie),t.uniform1i(t.getUniformLocation(T,"texture"),0),t.uniform1fv(t.getUniformLocation(T,"textureWidth"),[e]),t.uniform1fv(t.getUniformLocation(T,"textureHeight"),[a]),t.uniform1fv(t.getUniformLocation(T,"size"),[m]),t.drawArrays(t.TRIANGLE_STRIP,0,4),f=await ce(o),p=ee(t,f),t.deleteTexture(ie),t.useProgram(E),t.enableVertexAttribArray(t.getAttribLocation(E,"position")),t.vertexAttribPointer(t.getAttribLocation(E,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,p),t.uniform1i(t.getUniformLocation(E,"texture"),0),t.uniform1fv(t.getUniformLocation(E,"textureWidth"),[e]),t.uniform1fv(t.getUniformLocation(E,"textureHeight"),[a]),t.uniform1fv(t.getUniformLocation(E,"size"),[m]),t.drawArrays(t.TRIANGLE_STRIP,0,4),O=await ce(o),ie=ee(t,O),t.deleteTexture(p),t.useProgram(z),t.enableVertexAttribArray(t.getAttribLocation(z,"position")),t.vertexAttribPointer(t.getAttribLocation(z,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,l),t.uniform1i(t.getUniformLocation(z,"texture1"),0),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(t.getUniformLocation(z,"texture2"),1),t.uniform1iv(t.getUniformLocation(z,"type"),[3]),t.drawArrays(t.TRIANGLE_STRIP,0,4);let he=await ce(o),_=ee(t,he);return t.useProgram(T),t.enableVertexAttribArray(t.getAttribLocation(T,"position")),t.vertexAttribPointer(t.getAttribLocation(T,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,_),t.uniform1i(t.getUniformLocation(T,"texture"),0),t.uniform1fv(t.getUniformLocation(T,"textureWidth"),[e]),t.uniform1fv(t.getUniformLocation(T,"textureHeight"),[a]),t.uniform1fv(t.getUniformLocation(T,"size"),[m]),t.drawArrays(t.TRIANGLE_STRIP,0,4),f=await ce(o),p=ee(t,f),t.deleteTexture(_),t.useProgram(E),t.enableVertexAttribArray(t.getAttribLocation(E,"position")),t.vertexAttribPointer(t.getAttribLocation(E,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,p),t.uniform1i(t.getUniformLocation(E,"texture"),0),t.uniform1fv(t.getUniformLocation(E,"textureWidth"),[e]),t.uniform1fv(t.getUniformLocation(E,"textureHeight"),[a]),t.uniform1fv(t.getUniformLocation(E,"size"),[m]),t.drawArrays(t.TRIANGLE_STRIP,0,4),he=await ce(o),_=ee(t,he),t.deleteTexture(p),t.useProgram(B),t.enableVertexAttribArray(t.getAttribLocation(B,"position")),t.vertexAttribPointer(t.getAttribLocation(B,"position"),2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,l),t.uniform1i(t.getUniformLocation(B,"texture"),0),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(t.getUniformLocation(B,"maskTexture"),1),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,L),t.uniform1i(t.getUniformLocation(B,"blurred_alpha"),2),t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,ie),t.uniform1i(t.getUniformLocation(B,"blurred_FA"),3),t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_2D,_),t.uniform1i(t.getUniformLocation(B,"blurred_B1A"),4),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.deleteProgram(T),t.deleteProgram(E),t.deleteProgram(z),t.deleteProgram(B),t.deleteShader(v),t.deleteShader(w),t.deleteShader(k),t.deleteShader(I),t.deleteShader(D),t.deleteTexture(l),t.deleteTexture(u),t.deleteTexture(L),t.deleteTexture(ie),t.deleteTexture(_),o}function xi({width:e,height:a,image:i,imageMask:r}){return Si(e,a,i,r)}const wi={},bi={},{complexBridge:te,penBridge:Ci,createCanvas:Zt,imageKit:Li,filterBridge:St,createCanvasWithExpand:Ti}={};async function qt(e){var i;if(!((i=e.outputImageLayer)!=null&&i.image))return;const a=Li.getGLCanvas();a&&(e.outputImageLayer.image.imageSource=rt(a))}async function Qt(e){var r,o;if(!((o=(r=e.outputImageLayer)==null?void 0:r.image)!=null&&o.imageSource)||e.isInitedEffect)return;const a=Date.now();let i=ut(e.outputImageLayer.image.imageSource);(i.width>5e3||i.height>5e3)&&(i=await Zt(5e3,5e3,i)),await St.setSrcImage(i,!1,!0),await St.initRealtimeFilter(),await te.initComplexFilter(),await te.loadConfigPath("multiConfig",wi,1,!1,void 0,bi),te.setEnableTotalControl(!1),te.setComplexFilterConfigArray(ea(e)),console.log("%c%s","color: green;",`初始化特效${(Date.now()-a)/1e3}秒`),e.isInitedEffect=!0}async function ki({store:e,localStore:a,width:i,height:r,image:o,imageMask:t,mattingMonitor:c}){var k;if(!((k=e.outputImageLayer)!=null&&k.image))return;const g=e.savedState.mattingDesign.blurConfig.value,m=await Zt(i,r,o);let v=t;if(g&&!e.savedState.mattingDesign.blurConfig.hidden){const{canvasMask:I}=await Ci.from(m).maskBlur(v,g);v=I}let w=null;if(e.savedState.mattingDesign.useBlurFilterRun)w=await xi({width:o.width,height:o.height,image:m,imageMask:v});else{const I=m.getContext("2d");I&&(I.globalCompositeOperation="destination-in",I.beginPath(),I.drawImage(v,0,0,o.width,o.height),w=m)}w?(w=await Ti(i,r,w,e.fringeExtraScale),ji(e,a),e.outputImageLayer.image.imageSource=rt(w),e.filterConfig.id||!(e.savedState.mattingDesign.shadowConfig.hidden&&e.savedState.mattingDesign.strokeConfig.hidden&&e.savedState.mattingDesign.glowConfig.hidden)?(await Qt(e),await qt(e)):e.outputImageLayer.image.imageSource=rt(w)):console.error(`前景提取${e.savedState.mattingDesign.useBlurFilterRun},合成无结果`)}async function gt(e){await Qt(e),te.setEnableTotalControl(!1),te.setComplexFilterConfigArray(ea(e)),await te.processRender(),await qt(e)}async function xt(e,a){e.savedState.mattingDesign.blurConfig.value=a}async function Di(e,a){e.savedState.mattingDesign.blurConfig.hidden=a}function ji(e,a){var i;if(e.originalImageLayerScale===e.outputImageLayerScale&&(i=e.outputImageLayer)!=null&&i.image){const{image:r}=e.outputImageLayer;r.naturalWidth=Math.floor(e.fringeExtraScale*e.naturalWidth),r.naturalHeight=Math.floor(e.fringeExtraScale*e.naturalHeight);const t=r.naturalWidth*e.originalImageLayerScale/e.outputImageLayer.width;Wt(a,e.outputImageLayer,We(e.outputImageLayer),t,new ct("")),e.outputImageLayer.top=Math.floor(e.outputImageLayer.top),e.outputImageLayer.left=Math.floor(e.outputImageLayer.left)}}function Kt(e){return Ca(e.savedState.mattingDesign.shadowConfig.x,e.savedState.mattingDesign.shadowConfig.y)}function Jt(e){return La(e.savedState.mattingDesign.shadowConfig.x,e.savedState.mattingDesign.shadowConfig.y)}async function wt(e,a){e.savedState.mattingDesign.shadowConfig.color=a}async function bt(e,a){e.savedState.mattingDesign.shadowConfig.opacity=a}async function Ct(e,a){e.savedState.mattingDesign.shadowConfig.blur=a}async function Lt(e,a){const{x:i,y:r}=te.polarCoordinates2EulerCoordinates(a,Jt(e));e.savedState.mattingDesign.shadowConfig.x=i,e.savedState.mattingDesign.shadowConfig.y=r}async function Tt(e,a){const{x:i,y:r}=te.polarCoordinates2EulerCoordinates(Kt(e),a);e.savedState.mattingDesign.shadowConfig.x=i,e.savedState.mattingDesign.shadowConfig.y=r}async function Ii(e,a){e.savedState.mattingDesign.shadowConfig.hidden=a}async function kt(e,a){e.savedState.mattingDesign.strokeConfig.color=a}async function Dt(e,a){e.savedState.mattingDesign.strokeConfig.opacity=a}async function et(e,a){e.savedState.mattingDesign.strokeConfig.size=a}async function jt(e,a){e.savedState.mattingDesign.strokeConfig.style=a}async function Ai(e,a){e.savedState.mattingDesign.strokeConfig.hidden=a}async function It(e,a){e.savedState.mattingDesign.glowConfig.color=a}async function At(e,a){e.savedState.mattingDesign.glowConfig.opacity=a}async function Rt(e,a){e.savedState.mattingDesign.glowConfig.blur=a}async function Ri(e,a){e.savedState.mattingDesign.glowConfig.hidden=a}function ea(e){const a={mColorA:e.savedState.mattingDesign.strokeConfig.opacity,mColorB:.10196078568696,mColorG:.56862747669219,mColorR:1,mComplexType:0,mEditColorEnable:!1,mEditSizeEnable:!0,mEnable:!1,mLayerStyle:1,mSize:.5};if(!e.savedState.mattingDesign.strokeConfig.hidden){if(a.mEnable=!0,e.savedState.mattingDesign.strokeConfig.color){a.mEditColorEnable=!0;const o=JSON.parse(Ke(e.savedState.mattingDesign.strokeConfig.color,"rgb","colorList").color);a.mColorR=Number(o[0])/255,a.mColorG=Number(o[1])/255,a.mColorB=Number(o[2])/255}a.mLayerStyle=e.savedState.mattingDesign.strokeConfig.style,a.mSize=e.savedState.mattingDesign.strokeConfig.size}const i={mBlur:.5,mColorA:e.savedState.mattingDesign.glowConfig.opacity,mColorB:.16470588743686,mColorG:.92941176891326,mColorR:1,mComplexType:1,mEditColorEnable:!1,mEditSizeEnable:!0,mEnable:!1,mLayerStyle:0};if(!e.savedState.mattingDesign.glowConfig.hidden){if(i.mEnable=!0,e.savedState.mattingDesign.glowConfig.color){i.mEditColorEnable=!0;const o=JSON.parse(Ke(e.savedState.mattingDesign.glowConfig.color,"rgb","colorList").color);i.mColorR=Number(o[0])/255,i.mColorG=Number(o[1])/255,i.mColorB=Number(o[2])/255}i.mBlur=e.savedState.mattingDesign.glowConfig.blur}const r={mBlur:.5,mColorA:e.savedState.mattingDesign.shadowConfig.opacity,mColorB:.60392159223556,mColorG:.35686275362968,mColorR:.21960784494876,mComplexType:2,mEditColorEnable:!1,mEditSizeEnable:!0,mEnable:!1,mLayerStyle:0,mOffsetX:1,mOffsetY:1};if(!e.savedState.mattingDesign.shadowConfig.hidden){if(r.mEnable=!0,e.savedState.mattingDesign.shadowConfig.color){r.mEditColorEnable=!0;const m=JSON.parse(Ke(e.savedState.mattingDesign.shadowConfig.color,"rgb","colorList").color);r.mColorR=Number(m[0])/255,r.mColorG=Number(m[1])/255,r.mColorB=Number(m[2])/255}r.mBlur=e.savedState.mattingDesign.shadowConfig.blur;const{x:o,y:t}=e.savedState.mattingDesign.shadowConfig,{offsetX:c,offsetY:g}=te.EulerCoordinates2OffsetCoordinates(o,t);r.mOffsetX=c,r.mOffsetY=g}return[a,i,r]}function Ei(){return 18}function _i(e){e.savedState.mattingDesign.imageResolvedMaskURL=e.maskCanvas.toDataURL()}async function Fi(e,a,i,r){const{outputImageLayer:o}=e,t=await Ot(e.savedState.mattingDesign.originalImageURL);o&&o.image&&(await ki({store:e,localStore:a,width:e.naturalWidth,height:e.naturalHeight,image:t,imageMask:e.maskCanvas,mattingMonitor:i}),_i(e))}function Bi(e){const a=e.maskShapeCanvas;if(a){const i=a.getContext("2d");if(i){const{image:r}=e.savedState.mattingDesign.page.originalImageLayer;r&&(i.fillStyle=e.state.areaColor,i.globalCompositeOperation="source-over",i.clearRect(0,0,r.naturalWidth,r.naturalHeight),i.fillRect(0,0,r.naturalWidth,r.naturalHeight),i.globalCompositeOperation="destination-in",i.drawImage(e.maskCanvas,0,0,r.naturalWidth,r.naturalHeight))}}}const ta=A(({store:e,localStore:a})=>{const i=a.getPageScale();function r(){return e.isStrokeMode?e.state.pointerInBound:!1}function o(){return e.leftTab==="stroke"?e.state.strokeWidth:Ei()}return n.jsx("div",{className:"PointerCircle",style:{position:"absolute",display:r()?"":"none",left:a.pointerCurrentPositionInPage.x*i,top:a.pointerCurrentPositionInPage.y*i,width:o(),height:o(),background:"rgba(255, 255, 255, 0.5)",borderRadius:1e4,pointerEvents:"none",transform:"translate3d(-50%, -50%, 0)",boxSizing:"border-box",border:"2px solid rgba(255, 255, 255, 0.8)"}})}),Et=A(({isTop:e,onPointerDown:a})=>n.jsx("div",{style:{position:"absolute",left:"50%",width:36,height:6,cursor:"ns-resize",background:"var(--content--function-u-i-overlay-hover)",...e?{top:2,transform:"translate(-50%, -100%)"}:{bottom:2,transform:"translate(-50%, 100%)"}},onPointerDown:i=>{i.stopPropagation(),a(i,e?"bottom":"top")}})),_t=A(({isLeft:e,onPointerDown:a})=>n.jsx("div",{style:{position:"absolute",top:"50%",width:6,height:36,cursor:"ew-resize",background:"var(--content--function-u-i-overlay-hover)",...e?{left:2,transform:"translate(-100%,-50%)"}:{right:2,transform:"translate(100%,-50%)"}},onPointerDown:i=>{i.stopPropagation(),a(i,e?"right":"left")}})),Pe=A(({direction:e,onPointerDown:a})=>{const i={nw:{origin:"rightBottom",style:{top:-4,left:-4,cursor:"nwse-resize"}},ne:{origin:"leftBottom",style:{top:-4,right:-4,transform:"rotate(90deg)",cursor:"nesw-resize"}},sw:{origin:"rightTop",style:{bottom:-4,left:-4,transform:"rotate(-90deg)",cursor:"nesw-resize"}},se:{origin:"leftTop",style:{bottom:-4,right:-4,transform:"rotate(180deg)",cursor:"nwse-resize"}}};return n.jsxs("div",{style:{position:"absolute",width:30,height:30,...i[e].style},onPointerDown:r=>{r.stopPropagation(),a(r,i[e].origin)},children:[n.jsx("div",{style:{width:30,height:6,background:"var(--content--function-u-i-overlay-hover)"}}),n.jsx("div",{style:{width:6,height:24,background:"var(--content--function-u-i-overlay-hover)"}})]})}),aa=A(({rect:e,rectPointerDown:a,cornerPointerDown:i,borderPointerDown:r,boxShadow:o,isFree:t,childContainer:c})=>n.jsxs("div",{style:{position:"absolute",left:e.left,top:e.top,width:e.width,height:e.height,boxShadow:o?"rgba(255, 255, 255, 0.85) 0px 0px 0px 10000px":"",transform:e.rotate?`rotate(${e.rotate||0}deg)`:""},children:[n.jsx("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",border:"2px solid var(--content--function-u-i-overlay-hover)",boxSizing:"border-box",cursor:"move"},onPointerDown:g=>{g.stopPropagation(),a(g)}}),t?n.jsxs(n.Fragment,{children:[n.jsx(Et,{isTop:!0,onPointerDown:r}),n.jsx(Et,{onPointerDown:r}),n.jsx(_t,{isLeft:!0,onPointerDown:r}),n.jsx(_t,{onPointerDown:r})]}):null,n.jsx(Pe,{direction:"nw",onPointerDown:i}),n.jsx(Pe,{direction:"ne",onPointerDown:i}),n.jsx(Pe,{direction:"sw",onPointerDown:i}),n.jsx(Pe,{direction:"se",onPointerDown:i}),c]})),Hi=A(({store:e,localStore:a})=>{var r;const i=a.getPageScale();return n.jsxs("div",{children:[(r=e.outputImageLayer)==null?void 0:r.extra.rectList.map(o=>n.jsx(aa,{boxShadow:!1,isFree:!0,rect:{left:o.left*i,top:o.top*i,width:o.width*i,height:o.height*i,rotate:o.rotate},rectPointerDown:t=>{t.stopPropagation(),e.selectedRectId=o.id,ue(a,t),a.currentStatus="movingRect"},cornerPointerDown:(t,c)=>{e.selectedRectId=o.id,a.resizeOriginType=c,a.currentStatus="resizingEliminatorFrameByCorner",ue(a,t)},borderPointerDown:(t,c)=>{e.selectedRectId=o.id,a.resizeOriginType=c,a.currentStatus="resizingEliminatorFrameByBorder",ue(a,t)}},o.id)),a.currentStatus==="drawingRect"?n.jsx("div",{style:{position:"absolute",left:e.candidateRect.left*i,top:e.candidateRect.top*i,width:e.candidateRect.width*i,height:e.candidateRect.height*i,transform:`rotate(${e.candidateRect.rotate}deg)`,background:"rgba(112, 203, 255, 0.5)"}}):null]})}),Pi=A(({store:e,localStore:a})=>{const i=$(()=>({get isRectMode(){return e.leftTab==="identify"&&e.savedState.mattingDesign.mattingType===2}})),r=a.getPageScale(),{width:o,height:t}=a.props.getPageSize(),{image:c}=e.page.originalImageLayer;X.useEffect(()=>{e.state.pointerInBound=!1},[a.getPageScale()]),X.useEffect(()=>{e.savedState.mattingDesign.imageResolvedMaskURL&&Ot(e.savedState.mattingDesign.imageResolvedMaskURL).then(m=>Na(e.maskCanvas,m)).then(()=>{Bi(e)})},[e.savedState.mattingDesign.imageResolvedMaskURL]);function g(){return e.leftTab===""?"grab":(i.isRectMode,"")}return n.jsxs("div",{className:"LeftOverlay",style:{position:"absolute",left:0,top:0},children:[n.jsx(Ne,{style:{cursor:g()},onPointerDown:m=>{},children:n.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",width:o*r,height:t*r},children:c?n.jsxs("div",{style:{position:"absolute",left:e.page.originalImageLayer.left*r,top:e.page.originalImageLayer.top*r,width:e.page.originalImageLayer.width*r,height:e.page.originalImageLayer.height*r,transform:`rotate(${e.page.originalImageLayer.rotate}deg) scale(${c.flipH?"-1":"1"}, ${c.flipV?"-1":"1"})`},onPointerDown:m=>{var v;m.stopPropagation(),e.leftTab===""?(a.currentStatus="movingPageInWorkspaceWithoutBounds",ue(a,m)):e.isStrokeMode?(a.currentStatus="drawingMattingStrokePath",(v=a.props.matting)==null||v.startStrokePath(m)):i.isRectMode&&(e.candidateRect=pe(),Ka(a,e.originalImageLayer,e.candidateRect,m))},children:[n.jsx("canvas",{ref:m=>{e.maskShapeCanvas=m},style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.6},width:c.naturalWidth,height:c.naturalHeight}),n.jsx("canvas",{ref:m=>{e.leftStrokeCanvas=m},style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.6},width:c.naturalWidth,height:c.naturalHeight})]}):null})}),i.isRectMode?n.jsx(Hi,{store:e,localStore:a}):null,n.jsx(ta,{store:e,localStore:a})]})}),zi=A(({store:e,localStore:a,imageMattingText:i})=>{const r=a.getPageScale(),{width:o,height:t}=a.props.getPageSize();return n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{width:"100%",height:"100%",opacity:.5}}),n.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",width:o*r,height:t*r},children:n.jsx(aa,{isFree:e.pageFrameFreeScaleVisible,rect:{left:e.savedState.pageFrame.left*r,top:e.savedState.pageFrame.top*r,width:e.savedState.pageFrame.width*r,height:e.savedState.pageFrame.height*r},boxShadow:!0,rectPointerDown:c=>{Ta(a),a.currentStatus="movingPageFrame",ue(a,c)},cornerPointerDown:(c,g)=>{ue(a,c),a.resizeOriginType=g,e.pageFrameFreeScaleVisible?a.currentStatus="resizingPageFrameFreelyByCorner":a.currentStatus="resizingPageFrameByCorner"},borderPointerDown:(c,g)=>{a.currentStatus="resizingPageFrameByBorder",a.resizeOriginType=g,ue(a,c)},childContainer:null})})]})}),Mi=A(({store:e,localStore:a})=>{const i=a.getPageScale(),{width:r,height:o}=a.props.getPageSize(),{originalImageLayer:t}=e.page,{image:c}=t;return c&&e.isStrokeMode?n.jsxs(n.Fragment,{children:[n.jsx(Ne,{style:{cursor:"grab"},onPointerDown:g=>{ot(a,g)},children:n.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",width:r*i,height:o*i},children:[n.jsx("canvas",{ref:g=>{e.rightFragmentCanvas=g},style:{position:"absolute",left:t.left*i,top:t.top*i,transform:`rotate(${t.rotate}deg) scale(${c.flipH?"-1":"1"}, ${c.flipV?"-1":"1"})`,width:t.width*i,height:t.height*i,pointerEvents:"none"},width:e.naturalWidth,height:e.naturalHeight}),n.jsx("canvas",{ref:g=>{e.currentStrokeCanvas=g},style:{position:"absolute",left:t.left*i,top:t.top*i,transform:`rotate(${t.rotate}deg) scale(${c.flipH?"-1":"1"}, ${c.flipV?"-1":"1"})`,width:t.width*i,height:t.height*i,pointerEvents:"none",opacity:e.isRealtime?0:.6},width:e.naturalWidth,height:e.naturalHeight})]})}),n.jsx(ta,{store:e,localStore:a})]}):n.jsx(Ne,{style:{cursor:"grab"},onPointerDown:g=>{ot(a,g)}})}),Ni=A(({store:e,localStore:a,imageMattingText:i})=>n.jsxs("div",{className:"RightOverlay",style:{position:"absolute",left:0,top:0},children:[e.onlyRight===!1?n.jsx(Mi,{store:e,localStore:a}):null,e.onlyRight===!0?n.jsx(Ne,{style:{cursor:"grab"},onPointerDown:r=>{ot(a,r)},children:e.rightTab==="size"?n.jsx(zi,{store:e,localStore:a,imageMattingText:i}):null}):null]})),Ui="_ToolSection_1ep7i_1",Wi="_toolContainer_1ep7i_4",Oi="_toolsWrapper_1ep7i_11",Vi="_toolBox_1ep7i_16",Gi="_active_1ep7i_32",Xi="_backButton_1ep7i_35",$i="_mattingToolContainer_1ep7i_49",Yi="_pageToolContainer_1ep7i_52",Zi="_disabled_1ep7i_55",W={ToolSection:Ui,toolContainer:Wi,toolsWrapper:Oi,toolBox:Vi,active:Gi,backButton:Xi,mattingToolContainer:$i,pageToolContainer:Yi,disabled:Zi};function qi({store:e,imageMattingText:a}){const i=$(()=>({isChange:!1,get strokeTypeId(){return e.state.strokeType==="ERASE"?"4001":"4002"}}));return n.jsx("div",{className:"",style:{width:"182px"},children:n.jsxs("div",{className:"",children:[n.jsxs("div",{children:[n.jsx("div",{className:"",style:{width:"72px"},onClick:()=>{e.state.strokeType!=="ERASE"&&(e.state.strokeType="ERASE")},children:a(r=>r.toolSection.eraser)}),n.jsx("div",{className:"",style:{width:"72px"},onClick:()=>{e.state.strokeType!=="BRUSH"&&(e.state.strokeType="BRUSH")},children:a(r=>r.toolSection.swipe)})]}),n.jsxs("div",{className:"",children:[n.jsxs("div",{className:"",children:[n.jsx("div",{className:"",children:a(r=>r.toolSection.size2)}),n.jsx("div",{className:"",children:n.jsx(ae,{bordered:!1,controls:!1,min:1,max:100,value:e.state.strokeWidth,onBlur:()=>{i.isChange=!1},onChange:r=>{typeof r=="number"&&(e.state.strokeWidth=r,i.isChange=!0)}})})]}),n.jsx("div",{className:"",children:n.jsx(je,{min:1,max:100,value:e.state.strokeWidth,tipFormatter:null,onAfterChange:r=>{i.isChange=!1},onChange:r=>{e.state.strokeWidth=r,i.isChange=!0}})})]}),n.jsxs("div",{className:"",children:[n.jsxs("div",{className:"",children:[n.jsx("div",{className:"",children:a(r=>r.toolSection.hardness)}),n.jsx("div",{className:"",children:n.jsx(ae,{bordered:!1,controls:!1,min:0,max:100,value:e.state.shadowBlur,onBlur:()=>{i.isChange=!1},onChange:r=>{typeof r=="number"&&(e.state.shadowBlur=r,i.isChange=!0)}})})]}),n.jsx("div",{className:"",children:n.jsx(je,{min:0,max:100,value:e.state.shadowBlur,tipFormatter:null,onAfterChange:r=>{i.isChange=!1},onChange:r=>{e.state.shadowBlur=r,i.isChange=!0}})})]})]})})}const Qi=A(qi);function ht(e){const{localStore:a}=e;ka({localStore:a,workspaceState:a.workspaceState,workspaceElement:document.querySelector(".RightWorkspace")})}function ia(e){e.savedState.pageFrame=Q.cloneDeep(e.page.backgroundLayer),e.savedState.pageFrame.left=0,e.savedState.pageFrame.top=0,e.savedState.pageFrame.width=e.page.width,e.savedState.pageFrame.height=e.page.height,e.outputImageLayer&&(e.savedState.outputCandidateLayer=Q.cloneDeep(e.outputImageLayer))}function Ft(e,a,i,r=0,o=0){e.savedState.pageFrame.width=a,e.savedState.pageFrame.height=i,r||o?(e.savedState.pageFrame.top=r,e.savedState.pageFrame.left=o):e.outputImageLayer&&(e.savedState.pageFrame.left=-(a-e.page.width)/2,e.savedState.pageFrame.top=-(i-e.page.height)/2)}function Ki(e,a,i){e.savedState.pageFrame.width>a&&(e.savedState.pageFrame.width=a),e.savedState.pageFrame.height>i&&(e.savedState.pageFrame.height=i)}function Ji(e){if(!e.image)return;const{width:a,height:i}=e,{width:r,height:o}=e.image,t=a/r,c=i/o,g=Math.max(t,c);e.image.width=r*g,e.image.height=o*g,e.image.imageX=0,e.image.imageY=0}function na(e,a){const{pageFrame:i}=e.savedState;e.page.width=i.width,e.page.height=i.height;const{outputCandidateLayer:r}=e.savedState;Ua(a,r,-i.left,-i.top,new ct("")),e.savedState.mattingDesign.page.normalLayerList[0]=Q.cloneDeep(r),i.left=0,i.top=0;const o=e.page.originalImageLayer.id,t=Q.cloneDeep(r);t.image&&(t.image.naturalWidth=e.naturalWidth,t.image.naturalHeight=e.naturalHeight,t.id=o,t.image.imageSource=e.savedState.mattingDesign.originalImageURL,t.image.imageSource=e.savedState.mattingDesign.originalImageURL,ra(e,t,e.outputCandidateLayerScale),e.page.originalImageLayer=t),e.page.backgroundLayer=Q.cloneDeep(e.savedState.pageFrame),ht(e)}function ra(e,a,i){if(a!=null&&a.image){const{image:r}=a,t=r.naturalWidth*i/a.width;Wt(e.localStore,a,We(a),t,new ct(""))}}function lt(e,a){ra(e,e.savedState.outputCandidateLayer,a)}function Ie(e,a,i){const r=Da(a);Wa(a,e.savedState.outputCandidateLayer,We(e.savedState.outputCandidateLayer),i-e.savedState.outputCandidateLayer.rotate,r)}function tt(e,a){e.pageFrameFreeScaleVisible=a}function ye(e,a){e.savedState.mattingDesign.activeSize=a}function oa(e){var a,i,r,o;return e.outputImageLayer?!!(e.savedState.pageFrame.width!==e.page.width||e.savedState.pageFrame.height!==e.page.height||e.savedState.pageFrame.top||e.savedState.pageFrame.left||e.savedState.outputCandidateLayer.rotate!==e.outputImageLayer.rotate||((a=e.savedState.outputCandidateLayer.image)==null?void 0:a.flipH)!==((i=e.outputImageLayer.image)==null?void 0:i.flipH)||((r=e.savedState.outputCandidateLayer.image)==null?void 0:r.flipV)!==((o=e.outputImageLayer.image)==null?void 0:o.flipV)||e.outputCandidateLayerScale!==e.outputImageLayerScale):!1}async function Bt(e,a){e.savedState.mattingDesign.originalImageURL&&(a==="size"&&ia(e),e.internalRightTab==="size"&&a!=="size"&&oa(e)&&(na(e,e.localStore),e.savedState.statsLogOption.sizeCount+=1,e.stepStore.record("ScaledLayerImage")),e.internalRightTab=a)}class en{constructor(){this.compressedImageInfo={volume:0,width:0,height:0},this.stack=[],this.rootStage=this.startStage("选择图片+抠图")}startStage(a){const i={name:a,level:0,startedAt:Date.now(),endedAt:0,seconds:0,children:[]};return this.currentStage&&(i.level=this.currentStage.level+1,this.currentStage.children.push(i)),this.stack.push(i),this.currentStage=i,i}finishStage(a){if(!this.currentStage||this.currentStage.name!==a){console.warn("Unexpected stage name");return}this.currentStage.endedAt=Date.now(),this.currentStage.seconds=(this.currentStage.endedAt-this.currentStage.startedAt)/1e3,this.stack.pop(),this.currentStage=this.stack[this.stack.length-1]}printSummary(){const a=[];this.printStage(this.rootStage,a),console.warn(this.compressedImageInfo),console.warn(a.join(`
`))}printStage(a,i){let r="";for(let o=0;o<a.level;o+=1)r+="    ";i.push(`${r}${a.name}: ${a.seconds}s`),a.children.forEach(o=>{this.printStage(o,i)})}}var st={},tn=e=>encodeURIComponent(e).replace(/[!'()*]/g,a=>`%${a.charCodeAt(0).toString(16).toUpperCase()}`),la="%[a-f0-9]{2}",Ht=new RegExp("("+la+")|([^%]+?)","gi"),Pt=new RegExp("("+la+")+","gi");function dt(e,a){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;a=a||1;var i=e.slice(0,a),r=e.slice(a);return Array.prototype.concat.call([],dt(i),dt(r))}function an(e){try{return decodeURIComponent(e)}catch{for(var a=e.match(Ht)||[],i=1;i<a.length;i++)e=dt(a,i).join(""),a=e.match(Ht)||[];return e}}function nn(e){for(var a={"%FE%FF":"��","%FF%FE":"��"},i=Pt.exec(e);i;){try{a[i[0]]=decodeURIComponent(i[0])}catch{var r=an(i[0]);r!==i[0]&&(a[i[0]]=r)}i=Pt.exec(e)}a["%C2"]="�";for(var o=Object.keys(a),t=0;t<o.length;t++){var c=o[t];e=e.replace(new RegExp(c,"g"),a[c])}return e}var rn=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return nn(e)}},on=(e,a)=>{if(!(typeof e=="string"&&typeof a=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(a==="")return[e];const i=e.indexOf(a);return i===-1?[e]:[e.slice(0,i),e.slice(i+a.length)]},ln=function(e,a){for(var i={},r=Object.keys(e),o=Array.isArray(a),t=0;t<r.length;t++){var c=r[t],g=e[c];(o?a.indexOf(c)!==-1:a(c,g,e))&&(i[c]=g)}return i};(function(e){const a=tn,i=rn,r=on,o=ln,t=l=>l==null,c=Symbol("encodeFragmentIdentifier");function g(l){switch(l.arrayFormat){case"index":return u=>(h,f)=>{const p=h.length;return f===void 0||l.skipNull&&f===null||l.skipEmptyString&&f===""?h:f===null?[...h,[w(u,l),"[",p,"]"].join("")]:[...h,[w(u,l),"[",w(p,l),"]=",w(f,l)].join("")]};case"bracket":return u=>(h,f)=>f===void 0||l.skipNull&&f===null||l.skipEmptyString&&f===""?h:f===null?[...h,[w(u,l),"[]"].join("")]:[...h,[w(u,l),"[]=",w(f,l)].join("")];case"colon-list-separator":return u=>(h,f)=>f===void 0||l.skipNull&&f===null||l.skipEmptyString&&f===""?h:f===null?[...h,[w(u,l),":list="].join("")]:[...h,[w(u,l),":list=",w(f,l)].join("")];case"comma":case"separator":case"bracket-separator":{const u=l.arrayFormat==="bracket-separator"?"[]=":"=";return h=>(f,p)=>p===void 0||l.skipNull&&p===null||l.skipEmptyString&&p===""?f:(p=p===null?"":p,f.length===0?[[w(h,l),u,w(p,l)].join("")]:[[f,w(p,l)].join(l.arrayFormatSeparator)])}default:return u=>(h,f)=>f===void 0||l.skipNull&&f===null||l.skipEmptyString&&f===""?h:f===null?[...h,w(u,l)]:[...h,[w(u,l),"=",w(f,l)].join("")]}}function m(l){let u;switch(l.arrayFormat){case"index":return(h,f,p)=>{if(u=/\[(\d*)\]$/.exec(h),h=h.replace(/\[\d*\]$/,""),!u){p[h]=f;return}p[h]===void 0&&(p[h]={}),p[h][u[1]]=f};case"bracket":return(h,f,p)=>{if(u=/(\[\])$/.exec(h),h=h.replace(/\[\]$/,""),!u){p[h]=f;return}if(p[h]===void 0){p[h]=[f];return}p[h]=[].concat(p[h],f)};case"colon-list-separator":return(h,f,p)=>{if(u=/(:list)$/.exec(h),h=h.replace(/:list$/,""),!u){p[h]=f;return}if(p[h]===void 0){p[h]=[f];return}p[h]=[].concat(p[h],f)};case"comma":case"separator":return(h,f,p)=>{const H=typeof f=="string"&&f.includes(l.arrayFormatSeparator),L=typeof f=="string"&&!H&&k(f,l).includes(l.arrayFormatSeparator);f=L?k(f,l):f;const O=H||L?f.split(l.arrayFormatSeparator).map(ie=>k(ie,l)):f===null?f:k(f,l);p[h]=O};case"bracket-separator":return(h,f,p)=>{const H=/(\[\])$/.test(h);if(h=h.replace(/\[\]$/,""),!H){p[h]=f&&k(f,l);return}const L=f===null?[]:f.split(l.arrayFormatSeparator).map(O=>k(O,l));if(p[h]===void 0){p[h]=L;return}p[h]=[].concat(p[h],L)};default:return(h,f,p)=>{if(p[h]===void 0){p[h]=f;return}p[h]=[].concat(p[h],f)}}}function v(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(l,u){return u.encode?u.strict?a(l):encodeURIComponent(l):l}function k(l,u){return u.decode?i(l):l}function I(l){return Array.isArray(l)?l.sort():typeof l=="object"?I(Object.keys(l)).sort((u,h)=>Number(u)-Number(h)).map(u=>l[u]):l}function D(l){const u=l.indexOf("#");return u!==-1&&(l=l.slice(0,u)),l}function T(l){let u="";const h=l.indexOf("#");return h!==-1&&(u=l.slice(h)),u}function E(l){l=D(l);const u=l.indexOf("?");return u===-1?"":l.slice(u+1)}function z(l,u){return u.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):u.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function B(l,u){u=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},u),v(u.arrayFormatSeparator);const h=m(u),f=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return f;for(const p of l.split("&")){if(p==="")continue;let[H,L]=r(u.decode?p.replace(/\+/g," "):p,"=");L=L===void 0?null:["comma","separator","bracket-separator"].includes(u.arrayFormat)?L:k(L,u),h(k(H,u),L,f)}for(const p of Object.keys(f)){const H=f[p];if(typeof H=="object"&&H!==null)for(const L of Object.keys(H))H[L]=z(H[L],u);else f[p]=z(H,u)}return u.sort===!1?f:(u.sort===!0?Object.keys(f).sort():Object.keys(f).sort(u.sort)).reduce((p,H)=>{const L=f[H];return L&&typeof L=="object"&&!Array.isArray(L)?p[H]=I(L):p[H]=L,p},Object.create(null))}e.extract=E,e.parse=B,e.stringify=(l,u)=>{if(!l)return"";u=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},u),v(u.arrayFormatSeparator);const h=L=>u.skipNull&&t(l[L])||u.skipEmptyString&&l[L]==="",f=g(u),p={};for(const L of Object.keys(l))h(L)||(p[L]=l[L]);const H=Object.keys(p);return u.sort!==!1&&H.sort(u.sort),H.map(L=>{const O=l[L];return O===void 0?"":O===null?w(L,u):Array.isArray(O)?O.length===0&&u.arrayFormat==="bracket-separator"?w(L,u)+"[]":O.reduce(f(L),[]).join("&"):w(L,u)+"="+w(O,u)}).filter(L=>L.length>0).join("&")},e.parseUrl=(l,u)=>{u=Object.assign({decode:!0},u);const[h,f]=r(l,"#");return Object.assign({url:h.split("?")[0]||"",query:B(E(l),u)},u&&u.parseFragmentIdentifier&&f?{fragmentIdentifier:k(f,u)}:{})},e.stringifyUrl=(l,u)=>{u=Object.assign({encode:!0,strict:!0,[c]:!0},u);const h=D(l.url).split("?")[0]||"",f=e.extract(l.url),p=e.parse(f,{sort:!1}),H=Object.assign(p,l.query);let L=e.stringify(H,u);L&&(L=`?${L}`);let O=T(l.url);return l.fragmentIdentifier&&(O=`#${u[c]?w(l.fragmentIdentifier,u):l.fragmentIdentifier}`),`${h}${L}${O}`},e.pick=(l,u,h)=>{h=Object.assign({parseFragmentIdentifier:!0,[c]:!1},h);const{url:f,query:p,fragmentIdentifier:H}=e.parseUrl(l,h);return e.stringifyUrl({url:f,query:o(p,u),fragmentIdentifier:H},h)},e.exclude=(l,u,h)=>{const f=Array.isArray(u)?p=>!u.includes(p):(p,H)=>!u(p,H);return e.pick(l,f,h)}})(st);function sa(){const e={};return Object.assign(e,st.parse(window.location.search.split("?")[1]||"")),Object.assign(e,st.parse(window.location.hash.split("?")[1]||"")),e}function sn(e){e.savedState.mattingDesign.mattingType=-1;const a=sa();typeof a.mattingType<"u"&&(e.savedState.mattingDesign.mattingType=Number(a.mattingType)),e.internalRightTab="",e.leftTab="",e.stepStore.stepCursor=-1,e.statsLogOption.removeCount=0,e.statsLogOption.retainCount=0,e.statsLogOption.repairCount=0,e.statsLogOption.sizeCount=0}async function dn({store:e,imageURL:a}){sn(e),Oa();const i=await mt(null,a);e.page.width=i.width,e.page.height=i.height,e.localStore.workspaceState.positionLeft=0,e.localStore.workspaceState.positionTop=0,e.savedState.mattingDesign.originalImageURL=a,e.page.originalImageLayer=i,e.page.backgroundLayer=pe(),e.savedState.mattingDesign.filterConfig={groupId:"",id:"",zip:"",alpha:0},e.savedState.mattingDesign.activeSize="",e.savedState.mattingDesign.blurConfig={value:0,hidden:!0},e.savedState.mattingDesign.shadowConfig={color:"",opacity:1,blur:0,x:0,y:0,hidden:!0},e.savedState.mattingDesign.strokeConfig={color:"",opacity:1,size:0,style:1,hidden:!0},e.savedState.mattingDesign.glowConfig={color:"",opacity:1,blur:0,hidden:!0};const r=await mt(null,a);e.page.normalLayerList=[r],ht(e),e.isRealtime&&e.updateFilteredCanvas()}function at({store:e,imageMattingText:a,fileList:i,uploadFinishHandler:r}){const o=new en;return e.updateLoadInfo({step:0,text:a(t=>t.uploadImageSection.imageUploading),cancelInfo:{isCanceled:!1,onCancel:()=>{}}}),$t({fileList:i,multiple:!1,maxCount:1,accept:["image/jpg","image/jpeg","image/png","image/heic"],maatType:"matting",beforeUpload(){e.updateLoadInfo({isGlobalLoading:!0,step:1,text:a(t=>t.uploadImageSection.imageUploading)})},showProgress:!1,mattingMonitor:o,cancelInfo:e.loadInfo.cancelInfo}).then(async t=>{if(e.initVerification(),e.loadInfo.cancelInfo.isCanceled)return;e.updateLoadInfo({step:2,text:a(g=>g.uploadImageSection.imageMatting)});const c=t[0];e.savedState.mattingDesign.originalImageName=c.name,e.statsLogInfo.original_size=`${c.width}*${c.height}_${(c.size/1024/1024).toFixed(3)}`,r&&r(),o.finishStage("上传图片 uploading"),await dn({store:e,imageURL:c.url}),e.stepStore.record("PerformedImageMatting"),e.sodImageFeedBackVisible||da(e)}).catch(t=>{throw e.updateLoadInfo({isGlobalLoading:!1,step:0}),t})}async function cn(e){const a=e.naturalHeight>e.naturalWidth?800/e.naturalHeight:800/e.naturalWidth,i=new qa({type:"common",page:{...e.page,paddingWidth:0,borderRadiusPercent:0,imageLayerList:[]}},{});return await i.start(),await i.extract({extractType:"base64",imageType:"image/jpeg",quality:1,sizeRatio:a})}async function da(e){const a=await cn(e);$t({fileList:[Yt(a,e.savedState.mattingDesign.originalImageName)],multiple:!1,maxCount:1,accept:["image/jpg","image/jpeg","image/png","image/heic"],maatType:"matting",beforeUpload(){},showProgress:!1,messageHidden:!0}).then(i=>{i[0]})}function un({store:e,localStore:a,imageMattingText:i}){const r=$(()=>({leftTabMap:{areaDelete:{id:"20",text:i(t=>t.toolSection.areaDelete),tabName:"areaDelete",icon:"MinusCircleBoldFill",iconColor:"--content--function-selection-remove"},areaAdd:{id:"30",text:i(t=>t.toolSection.areaAdd),tabName:"areaAdd",icon:"PlusCircleBoldFill",iconColor:"--content--function-selection-add"},stroke:{id:"40",text:i(t=>t.toolSection.stroke),tabName:"stroke",icon:"EraserBoldFill",iconColor:""}},showAutoMattingPopover:!1,showRepairMattingPopover:!1}));X.useEffect(()=>{e.rightTab&&e.feedbackVisible},[e.rightTab]),X.useEffect(()=>{e.leftTab==="identify"&&!r.showAutoMattingPopover&&(r.showAutoMattingPopover=!0),e.leftTab==="stroke"&&!r.showRepairMattingPopover&&(r.showRepairMattingPopover=!0)},[e.leftTab]);function o(t){Bt(e,t)}return n.jsx("div",{className:W.ToolSection,children:n.jsxs("div",{className:W.toolContainer,children:[n.jsxs("div",{className:W.mattingToolContainer,children:[n.jsx(ne,{vShow:!e.rightTab,children:n.jsxs("div",{className:W.toolsWrapper,children:[Object.keys(r.leftTabMap).map(t=>r.leftTabMap[t]).map(t=>n.jsxs("div",{className:Le([W.toolBox,e.leftTab===t.tabName?W.active:""]),style:{width:"68px"},onClick:()=>{e.leftTab=t.tabName,t.tabName==="stroke"&&(e.state.strokeType="ERASE",r.showRepairMattingPopover=!r.showRepairMattingPopover),t.tabName!=="identify"?e.sodImageFeedBackVisible&&da(e):r.showAutoMattingPopover=!r.showAutoMattingPopover},children:[n.jsx("div",{className:W.toolIcon,children:"1"}),n.jsx("div",{className:W.toolName,children:t.text})]},t.text)),n.jsx(ne,{vShow:e.leftTab==="stroke"&&r.showRepairMattingPopover,style:{position:"absolute",top:"80px",left:"8px",zIndex:" 100"},children:n.jsx(Qi,{store:e,imageMattingText:i})})]})}),n.jsx(ne,{vShow:!!e.rightTab,children:n.jsx("div",{className:W.toolsWrapper,children:n.jsx("div",{onClick:()=>{Bt(e,"")},className:Le([W.backButton,"plainButton"]),children:n.jsx("span",{style:{marginLeft:"5px"},children:i(t=>t.toolSection.returnMatting)})})})})]}),n.jsx("div",{className:Le([W.pageToolContainer,e.savedState.mattingDesign.originalImageURL?"":W.disabled]),children:n.jsxs("div",{className:W.toolsWrapper,children:[n.jsx("div",{className:Le([W.toolBox,e.rightTab==="size"?W.active:""]),onClick:()=>{o("size")},children:n.jsx("div",{className:W.toolName,children:i(t=>t.toolSection.size)})}),n.jsxs("div",{className:Le([W.toolBox,e.rightTab==="edge"?W.active:""]),onClick:()=>{o("edge")},children:[n.jsx("div",{className:W.toolIcon,children:"1"}),n.jsx("div",{className:W.toolName,children:i(t=>t.toolSection.edge)})]})]})})]})})}const gn=A(un);var Oe={},ca={},Ve={exports:{}},De={exports:{}};(function(){var e,a,i,r,o,t;typeof performance<"u"&&performance!==null&&performance.now?De.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(De.exports=function(){return(e()-o)/1e6},a=process.hrtime,e=function(){var c;return c=a(),c[0]*1e9+c[1]},r=e(),t=process.uptime()*1e9,o=r-t):Date.now?(De.exports=function(){return Date.now()-i},i=Date.now()):(De.exports=function(){return new Date().getTime()-i},i=new Date().getTime())}).call(Ut);var hn=De.exports,fn=hn,re=typeof window>"u"?Ut:window,ze=["moz","webkit"],Se="AnimationFrame",we=re["request"+Se],Ae=re["cancel"+Se]||re["cancelRequest"+Se];for(var ke=0;!we&&ke<ze.length;ke++)we=re[ze[ke]+"Request"+Se],Ae=re[ze[ke]+"Cancel"+Se]||re[ze[ke]+"CancelRequest"+Se];if(!we||!Ae){var it=0,zt=0,fe=[],pn=1e3/60;we=function(e){if(fe.length===0){var a=fn(),i=Math.max(0,pn-(a-it));it=i+a,setTimeout(function(){var r=fe.slice(0);fe.length=0;for(var o=0;o<r.length;o++)if(!r[o].cancelled)try{r[o].callback(it)}catch(t){setTimeout(function(){throw t},0)}},Math.round(i))}return fe.push({handle:++zt,callback:e,cancelled:!1}),zt},Ae=function(e){for(var a=0;a<fe.length;a++)fe[a].handle===e&&(fe[a].cancelled=!0)}}Ve.exports=function(e){return we.call(re,e)};Ve.exports.cancel=function(){Ae.apply(re,arguments)};Ve.exports.polyfill=function(e){e||(e=re),e.requestAnimationFrame=we,e.cancelAnimationFrame=Ae};var mn=Ve.exports,Ge={exports:{}},nt=null,Mt=["Webkit","Moz","O","ms"],vn=function(a){nt||(nt=document.createElement("div"));var i=nt.style;if(a in i)return a;for(var r=a.charAt(0).toUpperCase()+a.slice(1),o=Mt.length;o>=0;o--){var t=Mt[o]+r;if(t in i)return t}return!1},yn=bn,Sn=/\s/,xn=/(_|-|\.|:)/,wn=/([a-z][A-Z]|[A-Z][a-z])/;function bn(e){return Sn.test(e)?e.toLowerCase():xn.test(e)?(Ln(e)||e).toLowerCase():wn.test(e)?kn(e).toLowerCase():e.toLowerCase()}var Cn=/[\W_]+(.|$)/g;function Ln(e){return e.replace(Cn,function(a,i){return i?" "+i:""})}var Tn=/(.)([A-Z]+)/g;function kn(e){return e.replace(Tn,function(a,i,r){return i+" "+r.toLowerCase().split("").join(" ")})}var Dn=yn,jn=In;function In(e){return Dn(e).replace(/[\W_]+(.|$)/g,function(a,i){return i?" "+i:""}).trim()}var An=jn,Rn=En;function En(e){return An(e).replace(/\s(\w)/g,function(a,i){return i.toUpperCase()})}var _n={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},Fn=function(e,a){return typeof a=="number"&&!_n[e]?a+"px":a},Bn=vn,Hn=Rn,Me={float:"cssFloat"},Pn=Fn;function Ue(e,a,i){var r=Me[a];if(typeof r>"u"&&(r=Mn(a)),r){if(i===void 0)return e.style[r];e.style[r]=Pn(r,i)}}function zn(e,a){for(var i in a)a.hasOwnProperty(i)&&Ue(e,i,a[i])}function Mn(e){var a=Hn(e),i=Bn(a);return Me[a]=Me[e]=Me[i]=i,i}function ua(){arguments.length===2?typeof arguments[1]=="string"?arguments[0].style.cssText=arguments[1]:zn(arguments[0],arguments[1]):Ue(arguments[0],arguments[1],arguments[2])}Ge.exports=ua;Ge.exports.set=ua;Ge.exports.get=function(e,a){return Array.isArray(a)?a.reduce(function(i,r){return i[r]=Ue(e,r||""),i},{}):Ue(e,a||"")};var ga=Ge.exports,ha={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;function a(i){return typeof i=="string"}})(ha);var fa={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t;var a=ga,i=r(a);function r(c){return c&&c.__esModule?c:{default:c}}var o=!1;function t(){if(o!==!1)return o;if(typeof document<"u"){var c=document.createElement("div");(0,i.default)(c,{width:100,height:100,position:"absolute",top:-9999,overflow:"scroll",MsOverflowStyle:"scrollbar"}),document.body.appendChild(c),o=c.offsetWidth-c.clientWidth,document.body.removeChild(c)}else o=0;return o||0}})(fa);var pa={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;function a(){return!1}})(pa);var ma={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;function a(i){var r=i.clientWidth,o=getComputedStyle(i),t=o.paddingLeft,c=o.paddingRight;return r-parseFloat(t)-parseFloat(c)}})(ma);var va={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;function a(i){var r=i.clientHeight,o=getComputedStyle(i),t=o.paddingTop,c=o.paddingBottom;return r-parseFloat(t)-parseFloat(c)}})(va);var Y={};Object.defineProperty(Y,"__esModule",{value:!0});Y.containerStyleDefault={position:"relative",overflow:"hidden",width:"100%",height:"100%"};Y.containerStyleAutoHeight={height:"auto"};Y.viewStyleDefault={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"scroll",WebkitOverflowScrolling:"touch"};Y.viewStyleAutoHeight={position:"relative",top:void 0,left:void 0,right:void 0,bottom:void 0};Y.viewStyleUniversalInitial={overflow:"hidden",marginRight:0,marginBottom:0};Y.trackHorizontalStyleDefault={position:"absolute",height:6};Y.trackVerticalStyleDefault={position:"absolute",width:6};Y.thumbHorizontalStyleDefault={position:"relative",display:"block",height:"100%"};Y.thumbVerticalStyleDefault={position:"relative",display:"block",width:"100%"};Y.disableSelectStyle={userSelect:"none"};Y.disableSelectStyleReset={userSelect:""};var me={};Object.defineProperty(me,"__esModule",{value:!0});var ge=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e};me.renderViewDefault=Wn;me.renderTrackHorizontalDefault=On;me.renderTrackVerticalDefault=Vn;me.renderThumbHorizontalDefault=Gn;me.renderThumbVerticalDefault=Xn;var Nn=X,_e=Un(Nn);function Un(e){return e&&e.__esModule?e:{default:e}}function Xe(e,a){var i={};for(var r in e)a.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function Wn(e){return _e.default.createElement("div",e)}function On(e){var a=e.style,i=Xe(e,["style"]),r=ge({},a,{right:2,bottom:2,left:2,borderRadius:3});return _e.default.createElement("div",ge({style:r},i))}function Vn(e){var a=e.style,i=Xe(e,["style"]),r=ge({},a,{right:2,bottom:2,top:2,borderRadius:3});return _e.default.createElement("div",ge({style:r},i))}function Gn(e){var a=e.style,i=Xe(e,["style"]),r=ge({},a,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return _e.default.createElement("div",ge({style:r},i))}function Xn(e){var a=e.style,i=Xe(e,["style"]),r=ge({},a,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return _e.default.createElement("div",ge({style:r},i))}(function(e){Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(_){for(var R=1;R<arguments.length;R++){var S=arguments[R];for(var d in S)Object.prototype.hasOwnProperty.call(S,d)&&(_[d]=S[d])}return _},i=function(){function _(R,S){for(var d=0;d<S.length;d++){var y=S[d];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(R,y.key,y)}}return function(R,S,d){return S&&_(R.prototype,S),d&&_(R,d),R}}(),r=mn,o=p(r),t=ga,c=p(t),g=X,m=Qa,v=p(m),w=ha,k=p(w),I=fa,D=p(I),T=pa,E=p(T),z=ma,B=p(z),l=va,u=p(l),h=Y,f=me;function p(_){return _&&_.__esModule?_:{default:_}}function H(_,R){var S={};for(var d in _)R.indexOf(d)>=0||Object.prototype.hasOwnProperty.call(_,d)&&(S[d]=_[d]);return S}function L(_,R){if(!(_ instanceof R))throw new TypeError("Cannot call a class as a function")}function O(_,R){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:_}function ie(_,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);_.prototype=Object.create(R&&R.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(_,R):_.__proto__=R)}var he=function(_){ie(R,_);function R(S){var d;L(this,R);for(var y=arguments.length,x=Array(y>1?y-1:0),j=1;j<y;j++)x[j-1]=arguments[j];var s=O(this,(d=R.__proto__||Object.getPrototypeOf(R)).call.apply(d,[this,S].concat(x)));return s.getScrollLeft=s.getScrollLeft.bind(s),s.getScrollTop=s.getScrollTop.bind(s),s.getScrollWidth=s.getScrollWidth.bind(s),s.getScrollHeight=s.getScrollHeight.bind(s),s.getClientWidth=s.getClientWidth.bind(s),s.getClientHeight=s.getClientHeight.bind(s),s.getValues=s.getValues.bind(s),s.getThumbHorizontalWidth=s.getThumbHorizontalWidth.bind(s),s.getThumbVerticalHeight=s.getThumbVerticalHeight.bind(s),s.getScrollLeftForOffset=s.getScrollLeftForOffset.bind(s),s.getScrollTopForOffset=s.getScrollTopForOffset.bind(s),s.scrollLeft=s.scrollLeft.bind(s),s.scrollTop=s.scrollTop.bind(s),s.scrollToLeft=s.scrollToLeft.bind(s),s.scrollToTop=s.scrollToTop.bind(s),s.scrollToRight=s.scrollToRight.bind(s),s.scrollToBottom=s.scrollToBottom.bind(s),s.handleTrackMouseEnter=s.handleTrackMouseEnter.bind(s),s.handleTrackMouseLeave=s.handleTrackMouseLeave.bind(s),s.handleHorizontalTrackMouseDown=s.handleHorizontalTrackMouseDown.bind(s),s.handleVerticalTrackMouseDown=s.handleVerticalTrackMouseDown.bind(s),s.handleHorizontalThumbMouseDown=s.handleHorizontalThumbMouseDown.bind(s),s.handleVerticalThumbMouseDown=s.handleVerticalThumbMouseDown.bind(s),s.handleWindowResize=s.handleWindowResize.bind(s),s.handleScroll=s.handleScroll.bind(s),s.handleDrag=s.handleDrag.bind(s),s.handleDragEnd=s.handleDragEnd.bind(s),s.state={didMountUniversal:!1},s}return i(R,[{key:"componentDidMount",value:function(){this.addListeners(),this.update(),this.componentDidMountUniversal()}},{key:"componentDidMountUniversal",value:function(){var d=this.props.universal;d&&this.setState({didMountUniversal:!0})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){this.removeListeners(),(0,r.cancel)(this.requestFrame),clearTimeout(this.hideTracksTimeout),clearInterval(this.detectScrollingInterval)}},{key:"getScrollLeft",value:function(){return this.view?this.view.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.view?this.view.scrollTop:0}},{key:"getScrollWidth",value:function(){return this.view?this.view.scrollWidth:0}},{key:"getScrollHeight",value:function(){return this.view?this.view.scrollHeight:0}},{key:"getClientWidth",value:function(){return this.view?this.view.clientWidth:0}},{key:"getClientHeight",value:function(){return this.view?this.view.clientHeight:0}},{key:"getValues",value:function(){var d=this.view||{},y=d.scrollLeft,x=y===void 0?0:y,j=d.scrollTop,s=j===void 0?0:j,P=d.scrollWidth,U=P===void 0?0:P,G=d.scrollHeight,oe=G===void 0?0:G,K=d.clientWidth,le=K===void 0?0:K,Z=d.clientHeight,J=Z===void 0?0:Z;return{left:x/(U-le)||0,top:s/(oe-J)||0,scrollLeft:x,scrollTop:s,scrollWidth:U,scrollHeight:oe,clientWidth:le,clientHeight:J}}},{key:"getThumbHorizontalWidth",value:function(){var d=this.props,y=d.thumbSize,x=d.thumbMinSize,j=this.view,s=j.scrollWidth,P=j.clientWidth,U=(0,B.default)(this.trackHorizontal),G=Math.ceil(P/s*U);return U===G?0:y||Math.max(G,x)}},{key:"getThumbVerticalHeight",value:function(){var d=this.props,y=d.thumbSize,x=d.thumbMinSize,j=this.view,s=j.scrollHeight,P=j.clientHeight,U=(0,u.default)(this.trackVertical),G=Math.ceil(P/s*U);return U===G?0:y||Math.max(G,x)}},{key:"getScrollLeftForOffset",value:function(d){var y=this.view,x=y.scrollWidth,j=y.clientWidth,s=(0,B.default)(this.trackHorizontal),P=this.getThumbHorizontalWidth();return d/(s-P)*(x-j)}},{key:"getScrollTopForOffset",value:function(d){var y=this.view,x=y.scrollHeight,j=y.clientHeight,s=(0,u.default)(this.trackVertical),P=this.getThumbVerticalHeight();return d/(s-P)*(x-j)}},{key:"scrollLeft",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.view&&(this.view.scrollLeft=d)}},{key:"scrollTop",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.view&&(this.view.scrollTop=d)}},{key:"scrollToLeft",value:function(){this.view&&(this.view.scrollLeft=0)}},{key:"scrollToTop",value:function(){this.view&&(this.view.scrollTop=0)}},{key:"scrollToRight",value:function(){this.view&&(this.view.scrollLeft=this.view.scrollWidth)}},{key:"scrollToBottom",value:function(){this.view&&(this.view.scrollTop=this.view.scrollHeight)}},{key:"addListeners",value:function(){if(!(typeof document>"u"||!this.view)){var d=this.view,y=this.trackHorizontal,x=this.trackVertical,j=this.thumbHorizontal,s=this.thumbVertical;d.addEventListener("scroll",this.handleScroll),(0,D.default)()&&(y.addEventListener("mouseenter",this.handleTrackMouseEnter),y.addEventListener("mouseleave",this.handleTrackMouseLeave),y.addEventListener("mousedown",this.handleHorizontalTrackMouseDown),x.addEventListener("mouseenter",this.handleTrackMouseEnter),x.addEventListener("mouseleave",this.handleTrackMouseLeave),x.addEventListener("mousedown",this.handleVerticalTrackMouseDown),j.addEventListener("mousedown",this.handleHorizontalThumbMouseDown),s.addEventListener("mousedown",this.handleVerticalThumbMouseDown),window.addEventListener("resize",this.handleWindowResize))}}},{key:"removeListeners",value:function(){if(!(typeof document>"u"||!this.view)){var d=this.view,y=this.trackHorizontal,x=this.trackVertical,j=this.thumbHorizontal,s=this.thumbVertical;d.removeEventListener("scroll",this.handleScroll),(0,D.default)()&&(y.removeEventListener("mouseenter",this.handleTrackMouseEnter),y.removeEventListener("mouseleave",this.handleTrackMouseLeave),y.removeEventListener("mousedown",this.handleHorizontalTrackMouseDown),x.removeEventListener("mouseenter",this.handleTrackMouseEnter),x.removeEventListener("mouseleave",this.handleTrackMouseLeave),x.removeEventListener("mousedown",this.handleVerticalTrackMouseDown),j.removeEventListener("mousedown",this.handleHorizontalThumbMouseDown),s.removeEventListener("mousedown",this.handleVerticalThumbMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.teardownDragging())}}},{key:"handleScroll",value:function(d){var y=this,x=this.props,j=x.onScroll,s=x.onScrollFrame;j&&j(d),this.update(function(P){var U=P.scrollLeft,G=P.scrollTop;y.viewScrollLeft=U,y.viewScrollTop=G,s&&s(P)}),this.detectScrolling()}},{key:"handleScrollStart",value:function(){var d=this.props.onScrollStart;d&&d(),this.handleScrollStartAutoHide()}},{key:"handleScrollStartAutoHide",value:function(){var d=this.props.autoHide;d&&this.showTracks()}},{key:"handleScrollStop",value:function(){var d=this.props.onScrollStop;d&&d(),this.handleScrollStopAutoHide()}},{key:"handleScrollStopAutoHide",value:function(){var d=this.props.autoHide;d&&this.hideTracks()}},{key:"handleWindowResize",value:function(){this.update()}},{key:"handleHorizontalTrackMouseDown",value:function(d){d.preventDefault();var y=d.target,x=d.clientX,j=y.getBoundingClientRect(),s=j.left,P=this.getThumbHorizontalWidth(),U=Math.abs(s-x)-P/2;this.view.scrollLeft=this.getScrollLeftForOffset(U)}},{key:"handleVerticalTrackMouseDown",value:function(d){d.preventDefault();var y=d.target,x=d.clientY,j=y.getBoundingClientRect(),s=j.top,P=this.getThumbVerticalHeight(),U=Math.abs(s-x)-P/2;this.view.scrollTop=this.getScrollTopForOffset(U)}},{key:"handleHorizontalThumbMouseDown",value:function(d){d.preventDefault(),this.handleDragStart(d);var y=d.target,x=d.clientX,j=y.offsetWidth,s=y.getBoundingClientRect(),P=s.left;this.prevPageX=j-(x-P)}},{key:"handleVerticalThumbMouseDown",value:function(d){d.preventDefault(),this.handleDragStart(d);var y=d.target,x=d.clientY,j=y.offsetHeight,s=y.getBoundingClientRect(),P=s.top;this.prevPageY=j-(x-P)}},{key:"setupDragging",value:function(){(0,c.default)(document.body,h.disableSelectStyle),document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.handleDragEnd),document.onselectstart=E.default}},{key:"teardownDragging",value:function(){(0,c.default)(document.body,h.disableSelectStyleReset),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleDragEnd),document.onselectstart=void 0}},{key:"handleDragStart",value:function(d){this.dragging=!0,d.stopImmediatePropagation(),this.setupDragging()}},{key:"handleDrag",value:function(d){if(this.prevPageX){var y=d.clientX,x=this.trackHorizontal.getBoundingClientRect(),j=x.left,s=this.getThumbHorizontalWidth(),P=s-this.prevPageX,U=-j+y-P;this.view.scrollLeft=this.getScrollLeftForOffset(U)}if(this.prevPageY){var G=d.clientY,oe=this.trackVertical.getBoundingClientRect(),K=oe.top,le=this.getThumbVerticalHeight(),Z=le-this.prevPageY,J=-K+G-Z;this.view.scrollTop=this.getScrollTopForOffset(J)}return!1}},{key:"handleDragEnd",value:function(){this.dragging=!1,this.prevPageX=this.prevPageY=0,this.teardownDragging(),this.handleDragEndAutoHide()}},{key:"handleDragEndAutoHide",value:function(){var d=this.props.autoHide;d&&this.hideTracks()}},{key:"handleTrackMouseEnter",value:function(){this.trackMouseOver=!0,this.handleTrackMouseEnterAutoHide()}},{key:"handleTrackMouseEnterAutoHide",value:function(){var d=this.props.autoHide;d&&this.showTracks()}},{key:"handleTrackMouseLeave",value:function(){this.trackMouseOver=!1,this.handleTrackMouseLeaveAutoHide()}},{key:"handleTrackMouseLeaveAutoHide",value:function(){var d=this.props.autoHide;d&&this.hideTracks()}},{key:"showTracks",value:function(){clearTimeout(this.hideTracksTimeout),(0,c.default)(this.trackHorizontal,{opacity:1}),(0,c.default)(this.trackVertical,{opacity:1})}},{key:"hideTracks",value:function(){var d=this;if(!this.dragging&&!this.scrolling&&!this.trackMouseOver){var y=this.props.autoHideTimeout;clearTimeout(this.hideTracksTimeout),this.hideTracksTimeout=setTimeout(function(){(0,c.default)(d.trackHorizontal,{opacity:0}),(0,c.default)(d.trackVertical,{opacity:0})},y)}}},{key:"detectScrolling",value:function(){var d=this;this.scrolling||(this.scrolling=!0,this.handleScrollStart(),this.detectScrollingInterval=setInterval(function(){d.lastViewScrollLeft===d.viewScrollLeft&&d.lastViewScrollTop===d.viewScrollTop&&(clearInterval(d.detectScrollingInterval),d.scrolling=!1,d.handleScrollStop()),d.lastViewScrollLeft=d.viewScrollLeft,d.lastViewScrollTop=d.viewScrollTop},100))}},{key:"raf",value:function(d){var y=this;this.requestFrame&&o.default.cancel(this.requestFrame),this.requestFrame=(0,o.default)(function(){y.requestFrame=void 0,d()})}},{key:"update",value:function(d){var y=this;this.raf(function(){return y._update(d)})}},{key:"_update",value:function(d){var y=this.props,x=y.onUpdate,j=y.hideTracksWhenNotNeeded,s=this.getValues();if((0,D.default)()){var P=s.scrollLeft,U=s.clientWidth,G=s.scrollWidth,oe=(0,B.default)(this.trackHorizontal),K=this.getThumbHorizontalWidth(),le=P/(G-U)*(oe-K),Z={width:K,transform:"translateX("+le+"px)"},J=s.scrollTop,se=s.clientHeight,de=s.scrollHeight,Ye=(0,u.default)(this.trackVertical),Fe=this.getThumbVerticalHeight(),Ze=J/(de-se)*(Ye-Fe),ve={height:Fe,transform:"translateY("+Ze+"px)"};if(j){var qe={visibility:G>U?"visible":"hidden"},Qe={visibility:de>se?"visible":"hidden"};(0,c.default)(this.trackHorizontal,qe),(0,c.default)(this.trackVertical,Qe)}(0,c.default)(this.thumbHorizontal,Z),(0,c.default)(this.thumbVertical,ve)}x&&x(s),typeof d=="function"&&d(s)}},{key:"render",value:function(){var d=this,y=(0,D.default)(),x=this.props;x.onScroll,x.onScrollFrame,x.onScrollStart,x.onScrollStop,x.onUpdate;var j=x.renderView,s=x.renderTrackHorizontal,P=x.renderTrackVertical,U=x.renderThumbHorizontal,G=x.renderThumbVertical,oe=x.tagName;x.hideTracksWhenNotNeeded;var K=x.autoHide;x.autoHideTimeout;var le=x.autoHideDuration;x.thumbSize,x.thumbMinSize;var Z=x.universal,J=x.autoHeight,se=x.autoHeightMin,de=x.autoHeightMax,Ye=x.style,Fe=x.children,Ze=H(x,["onScroll","onScrollFrame","onScrollStart","onScrollStop","onUpdate","renderView","renderTrackHorizontal","renderTrackVertical","renderThumbHorizontal","renderThumbVertical","tagName","hideTracksWhenNotNeeded","autoHide","autoHideTimeout","autoHideDuration","thumbSize","thumbMinSize","universal","autoHeight","autoHeightMin","autoHeightMax","style","children"]),ve=this.state.didMountUniversal,qe=a({},h.containerStyleDefault,J&&a({},h.containerStyleAutoHeight,{minHeight:se,maxHeight:de}),Ye),Qe=a({},h.viewStyleDefault,{marginRight:y?-y:0,marginBottom:y?-y:0},J&&a({},h.viewStyleAutoHeight,{minHeight:(0,k.default)(se)?"calc("+se+" + "+y+"px)":se+y,maxHeight:(0,k.default)(de)?"calc("+de+" + "+y+"px)":de+y}),J&&Z&&!ve&&{minHeight:se,maxHeight:de},Z&&!ve&&h.viewStyleUniversalInitial),pt={transition:"opacity "+le+"ms",opacity:0},Sa=a({},h.trackHorizontalStyleDefault,K&&pt,(!y||Z&&!ve)&&{display:"none"}),xa=a({},h.trackVerticalStyleDefault,K&&pt,(!y||Z&&!ve)&&{display:"none"});return(0,g.createElement)(oe,a({},Ze,{style:qe,ref:function(q){d.container=q}}),[(0,g.cloneElement)(j({style:Qe}),{key:"view",ref:function(q){d.view=q}},Fe),(0,g.cloneElement)(s({style:Sa}),{key:"trackHorizontal",ref:function(q){d.trackHorizontal=q}},(0,g.cloneElement)(U({style:h.thumbHorizontalStyleDefault}),{ref:function(q){d.thumbHorizontal=q}})),(0,g.cloneElement)(P({style:xa}),{key:"trackVertical",ref:function(q){d.trackVertical=q}},(0,g.cloneElement)(G({style:h.thumbVerticalStyleDefault}),{ref:function(q){d.thumbVertical=q}}))])}}]),R}(g.Component);e.default=he,he.propTypes={onScroll:v.default.func,onScrollFrame:v.default.func,onScrollStart:v.default.func,onScrollStop:v.default.func,onUpdate:v.default.func,renderView:v.default.func,renderTrackHorizontal:v.default.func,renderTrackVertical:v.default.func,renderThumbHorizontal:v.default.func,renderThumbVertical:v.default.func,tagName:v.default.string,thumbSize:v.default.number,thumbMinSize:v.default.number,hideTracksWhenNotNeeded:v.default.bool,autoHide:v.default.bool,autoHideTimeout:v.default.number,autoHideDuration:v.default.number,autoHeight:v.default.bool,autoHeightMin:v.default.oneOfType([v.default.number,v.default.string]),autoHeightMax:v.default.oneOfType([v.default.number,v.default.string]),universal:v.default.bool,style:v.default.object,children:v.default.node},he.defaultProps={renderView:f.renderViewDefault,renderTrackHorizontal:f.renderTrackHorizontalDefault,renderTrackVertical:f.renderTrackVerticalDefault,renderThumbHorizontal:f.renderThumbHorizontalDefault,renderThumbVertical:f.renderThumbVerticalDefault,tagName:"div",thumbMinSize:30,hideTracksWhenNotNeeded:!1,autoHide:!1,autoHideTimeout:1e3,autoHideDuration:200,autoHeight:!1,autoHeightMin:0,autoHeightMax:200,universal:!1}})(ca);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Scrollbars=void 0;var a=ca,i=r(a);function r(o){return o&&o.__esModule?o:{default:o}}e.default=i.default,e.Scrollbars=i.default})(Oe);const $n="_EdgeSetting_1ccka_1",Yn="_colorBox_1ccka_1",Zn="_colorDegree_1ccka_6",qn="_line_1ccka_11",Qn="_ContentHeader_1ccka_18",Kn="_operation_1ccka_18",Jn="_add_1ccka_29",er="_del_1ccka_39",tr="_SliderAndCircleInput_1ccka_49",ar="_inputNumberBox_1ccka_49",ir="_chevronBox_1ccka_58",nr="_iconBox_1ccka_70",rr="_ColorSelector_1ccka_89",or="_selectorContent_1ccka_89",lr="_colorValue_1ccka_97",sr="_colorIconBox_1ccka_106",dr="_colorIcon_1ccka_106",cr="_Stroke_1ccka_136",ur="_disable_1ccka_136",gr="_styleTitle_1ccka_149",hr="_styleBox_1ccka_156",fr="_styleContent_1ccka_160",pr="_styleActive_1ccka_173",F={EdgeSetting:$n,colorBox:Yn,colorDegree:Zn,line:qn,ContentHeader:Qn,operation:Kn,add:Jn,del:er,SliderAndCircleInput:tr,inputNumberBox:ar,chevronBox:ir,iconBox:nr,ColorSelector:rr,selectorContent:or,colorValue:lr,colorIconBox:sr,colorIcon:dr,Stroke:cr,disable:ur,styleTitle:gr,styleBox:hr,styleContent:fr,styleActive:pr},mr="data:image/png;base64,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",xe=A(({store:e,value:a,title:i,isCircle:r,min:o=0,max:t=100,onChange:c,onAfterChange:g})=>{const m=$(()=>({max:100,min:0,isChange:!1,isMouseDown:!1})),v=X.useRef(null);r&&X.useEffect(()=>(window.addEventListener("pointermove",k),window.addEventListener("pointerup",I),()=>{window.removeEventListener("pointermove",k),window.removeEventListener("pointerup",I)}),[]);function w(D){if(v.current){const T=v.current,E=T.offsetHeight/2+T.getBoundingClientRect().left,z=T.offsetWidth/2+T.getBoundingClientRect().top,B=-ja({x:D.pageX,y:D.pageY},{x:E,y:z});c(Math.floor(B))}}function k(D){m.isMouseDown&&w(D)}function I(D){m.isMouseDown&&(m.isMouseDown=!1,w(D),g("circle"))}return n.jsxs("div",{className:F.SliderAndCircleInput,style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",color:"var(--content--system-primary)",fontSize:14,lineHeight:"20px"},children:[n.jsx("span",{children:i}),r?n.jsx("div",{className:`plainButton ${F.circle}`,ref:v,style:{display:"flex",alignItems:"center",justifyContent:"center",width:26,height:26,marginRight:"auto",marginLeft:16,overflow:"hidden",backgroundColor:"var(--background--input)",border:"1px solid var(--stroke--input)",borderRadius:"50%"},onMouseDown:()=>{m.isMouseDown=!0},children:n.jsx("div",{className:F.center,style:{transform:`rotate(${-a}deg)`,position:"relative",width:0,height:0},children:n.jsx("div",{style:{position:"absolute",top:-3,left:3,width:6,height:6,background:"var(--text--normal_2)",borderRadius:"50%",cursor:"pointer"}})})}):n.jsx("div",{style:{flex:1,paddingRight:16,paddingLeft:16},children:n.jsx(je,{min:o,max:t,value:a,tipFormatter:null,onChange:D=>{m.isChange=!0,c(D)},onAfterChange:()=>{m.isChange&&(g("slider"),m.isChange=!1)}})}),n.jsxs("div",{className:F.inputNumberBox,children:[n.jsx(ae,{min:o,max:t,controls:!1,bordered:!1,value:a,className:"small",onChange:D=>{typeof D=="number"&&(m.isChange=!0,c(Math.floor(D)))},onPressEnter:()=>{g("input"),m.isChange=!1},onBlur:()=>{m.isChange&&(g("input"),m.isChange=!1)}}),n.jsxs("div",{className:F.chevronBox,children:[n.jsx("div",{className:`${F.iconBox} ${a<t?"":"pointDisable"}`,onClick:()=>{a<t&&(c(a+1),g("input"))},children:"1"}),n.jsx("div",{className:`${F.iconBox} ${a>o?"":"pointDisable"}`,onClick:()=>{a>o&&(c(a-1),g("input"))},children:"1"})]})]})]})}),$e=A(({hidden:e,title:a,iconName:i,onChange:r})=>n.jsxs("div",{className:F.ContentHeader,style:{display:"flex",alignItems:"center",color:"var(--content--system-primary)"},children:[n.jsx("div",{style:{width:18,height:18,marginRight:6},children:"1"}),n.jsx("div",{style:{fontWeight:600,fontSize:14,lineHeight:"20px"},children:a}),n.jsx("div",{className:F.operation,onClick:()=>{r(!e)},children:e?n.jsx("div",{className:`${F.add} plainButton`,children:"1"}):n.jsx("div",{className:`${F.del} plainButton`,children:"1"})})]})),ft=A(({value:e,onChange:a,onAfterChange:i})=>n.jsx("div",{className:F.ColorSelector,style:{position:"relative",width:62,height:26,overflow:"hidden",border:"none",borderRadius:8},children:n.jsxs("div",{className:F.selectorContent,children:[n.jsx("div",{className:F.colorValue,style:{backgroundColor:e}}),n.jsx("div",{className:F.colorIconBox,children:n.jsx("img",{className:F.colorIcon,src:mr,alt:""})})]})})),vr=A(({store:e,imageMattingText:a})=>{const i=$(()=>({isChange:!1}));function r(){e.loadInfo.isRightTabLoading||(e.loadInfo.isRightTabLoading=!0,setTimeout(async()=>{await gt(e),e.stepStore.record("ImageMattingEdgeUpdated"),e.loadInfo.isRightTabLoading=!1}))}function o(){r(),i.isChange=!1}return n.jsxs("div",{children:[n.jsx($e,{hidden:e.savedState.mattingDesign.shadowConfig.hidden,title:a(t=>t.mattingRightPanel.edgeSetting.shadow),iconName:"DropshadowBold",onChange:t=>{Ii(e,t),wt(e,"#414143"),bt(e,.8),Ct(e,.5),Lt(e,.3),Tt(e,-45),r()}}),n.jsxs("div",{style:{paddingTop:"12px",display:e.savedState.mattingDesign.shadowConfig.hidden?"none":"block"},children:[n.jsxs("div",{className:F.colorBox,children:[n.jsx(ft,{value:e.savedState.mattingDesign.shadowConfig.color,onChange:t=>{wt(e,t),r()},onAfterChange:()=>{}}),n.jsx("div",{className:F.colorDegree,children:n.jsx(ae,{addonAfter:n.jsx("div",{children:"%"}),min:0,max:100,controls:!1,bordered:!1,value:Math.round(e.savedState.mattingDesign.shadowConfig.opacity*100),className:"addonAfter small",onChange:t=>{typeof t=="number"&&(i.isChange=!0,bt(e,t/100))},onPressEnter:()=>{o()},onBlur:()=>{i.isChange&&o()}})})]}),n.jsx(xe,{store:e,value:Math.round(e.savedState.mattingDesign.shadowConfig.blur*100),title:a(t=>t.mattingRightPanel.edgeSetting.blur),onChange:t=>{Ct(e,t/100)},onAfterChange:t=>{r()}}),n.jsx("div",{style:{marginBottom:"10px"}}),n.jsx(xe,{store:e,value:Math.round(Kt(e)*100),title:a(t=>t.mattingRightPanel.edgeSetting.distance),onChange:t=>{Lt(e,t/100)},onAfterChange:t=>{r()}}),n.jsx("div",{style:{marginBottom:"13px"}}),n.jsx(xe,{store:e,value:Math.round(Jt(e)),title:a(t=>t.mattingRightPanel.edgeSetting.angle),min:-180,max:180,isCircle:!0,onChange:t=>{Tt(e,t)},onAfterChange:t=>{r()}})]})]})}),yr=[{style:0,icon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"9.75",y:"9.75",width:"22.5",height:"22.5",rx:"3.25",fill:"#D4D7D9",stroke:"#606266",strokeWidth:"1.5"}),n.jsx("path",{d:"M17.8789 21.2613C18.4756 20.59 19.5244 20.59 20.1211 21.2613L25.5206 27.3356C26.0938 27.9805 25.636 29 24.7732 29H13.2268C12.364 29 11.9062 27.9805 12.4794 27.3356L17.8789 21.2613Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.4008 23.1837C23.9943 22.5446 25.0057 22.5446 25.5992 23.1837L29.4396 27.3195C30.0337 27.9594 29.58 29 28.7068 29H20.2932C19.42 29 18.9663 27.9594 19.5604 27.3195L23.4008 23.1837Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"})]}),activeIcon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"9.75",y:"9.75",width:"22.5",height:"22.5",rx:"3.25",fill:"#CBB1FF",stroke:"#9966FF",strokeWidth:"1.5"}),n.jsx("path",{d:"M17.8789 21.2613C18.4756 20.59 19.5244 20.59 20.1211 21.2613L25.5206 27.3356C26.0938 27.9805 25.636 29 24.7732 29H13.2268C12.364 29 11.9062 27.9805 12.4794 27.3356L17.8789 21.2613Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.4008 23.1837C23.9943 22.5446 25.0057 22.5446 25.5992 23.1837L29.4396 27.3195C30.0337 27.9594 29.58 29 28.7068 29H20.2932C19.42 29 18.9663 27.9594 19.5604 27.3195L23.4008 23.1837Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"})]})},{style:1,icon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"7",y:"7",width:"28",height:"28",rx:"6",stroke:"#606266",strokeWidth:"1.5"}),n.jsx("rect",{x:"10",y:"10",width:"22",height:"22",rx:"3",fill:"#D4D7D9"}),n.jsx("path",{d:"M17.8477 21.3828C18.4474 20.6632 19.5526 20.6632 20.1523 21.3828L25.1332 27.3598C25.676 28.0111 25.2128 29 24.365 29H13.635C12.7872 29 12.324 28.0111 12.8668 27.3598L17.8477 21.3828Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.3611 23.3287C23.9598 22.6303 25.0402 22.6303 25.6389 23.3287L29.085 27.3492C29.641 27.9979 29.1801 29 28.3258 29H20.6742C19.8199 29 19.359 27.9979 19.915 27.3492L23.3611 23.3287Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"})]}),activeIcon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"7",y:"7",width:"28",height:"28",rx:"6",stroke:"#9966FF",strokeWidth:"1.5"}),n.jsx("rect",{x:"10",y:"10",width:"22",height:"22",rx:"3",fill:"#CBB1FF"}),n.jsx("path",{d:"M17.8477 21.3828C18.4474 20.6632 19.5526 20.6632 20.1523 21.3828L25.1332 27.3598C25.676 28.0111 25.2128 29 24.365 29H13.635C12.7872 29 12.324 28.0111 12.8668 27.3598L17.8477 21.3828Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.3611 23.3287C23.9598 22.6303 25.0402 22.6303 25.6389 23.3287L29.085 27.3492C29.641 27.9979 29.1801 29 28.3258 29H20.6742C19.8199 29 19.359 27.9979 19.915 27.3492L23.3611 23.3287Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"})]})},{style:2,icon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"7",y:"7",width:"28",height:"28",rx:"6",stroke:"#606266",strokeWidth:"1.5",strokeLinecap:"round",strokeDasharray:"5 4"}),n.jsx("rect",{x:"9",y:"9",width:"24",height:"24",rx:"4",fill:"#D4D7D9"}),n.jsx("path",{d:"M17.8789 21.2613C18.4756 20.59 19.5244 20.59 20.1211 21.2613L25.5206 27.3356C26.0938 27.9805 25.636 29 24.7732 29H13.2268C12.364 29 11.9062 27.9805 12.4794 27.3356L17.8789 21.2613Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.4008 23.1837C23.9943 22.5446 25.0057 22.5446 25.5992 23.1837L29.4396 27.3195C30.0337 27.9594 29.58 29 28.7068 29H20.2932C19.42 29 18.9663 27.9594 19.5604 27.3195L23.4008 23.1837Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"})]}),activeIcon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("rect",{x:"7",y:"7",width:"28",height:"28",rx:"6",stroke:"#9966FF",strokeWidth:"1.5",strokeLinecap:"round",strokeDasharray:"5 4"}),n.jsx("rect",{x:"9",y:"9",width:"24",height:"24",rx:"4",fill:"#CBB1FF"}),n.jsx("path",{d:"M17.8789 21.2613C18.4756 20.59 19.5244 20.59 20.1211 21.2613L25.5206 27.3356C26.0938 27.9805 25.636 29 24.7732 29H13.2268C12.364 29 11.9062 27.9805 12.4794 27.3356L17.8789 21.2613Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.4008 23.1837C23.9943 22.5446 25.0057 22.5446 25.5992 23.1837L29.4396 27.3195C30.0337 27.9594 29.58 29 28.7068 29H20.2932C19.42 29 18.9663 27.9594 19.5604 27.3195L23.4008 23.1837Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"})]})},{style:4,icon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("g",{filter:"url(#filter0_d_3295_42888)",children:n.jsx("path",{d:"M26.8052 6L18.3766 7.71429L8.41558 6.85714L6.5 13.7143L7.26623 25.2857L6.5 33.4286L14.5455 36L23.3571 34.2857L34.0844 34.7143L36 23.5714L34.0844 7.71429L26.8052 6Z",fill:"white"})}),n.jsx("rect",{x:"9",y:"9",width:"24",height:"24",rx:"5",fill:"#D4D7D9"}),n.jsx("path",{d:"M17.8789 21.2613C18.4756 20.59 19.5244 20.59 20.1211 21.2613L25.5206 27.3356C26.0938 27.9805 25.636 29 24.7732 29H13.2268C12.364 29 11.9062 27.9805 12.4794 27.3356L17.8789 21.2613Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.4008 23.1837C23.9943 22.5446 25.0057 22.5446 25.5992 23.1837L29.4396 27.3195C30.0337 27.9594 29.58 29 28.7068 29H20.2932C19.42 29 18.9663 27.9594 19.5604 27.3195L23.4008 23.1837Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"}),n.jsx("defs",{children:n.jsxs("filter",{id:"filter0_d_3295_42888",x:"3.5",y:"3.5",width:"35.5",height:"36",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[n.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),n.jsx("feOffset",{dy:"0.5"}),n.jsx("feGaussianBlur",{stdDeviation:"1.5"}),n.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),n.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),n.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3295_42888"}),n.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3295_42888",result:"shape"})]})})]}),activeIcon:n.jsxs("svg",{width:"42",height:"42",viewBox:"0 0 42 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("g",{filter:"url(#filter0_d_3295_43268)",children:n.jsx("path",{d:"M26.8052 6L18.3766 7.71429L8.41558 6.85714L6.5 13.7143L7.26623 25.2857L6.5 33.4286L14.5455 36L23.3571 34.2857L34.0844 34.7143L36 23.5714L34.0844 7.71429L26.8052 6Z",fill:"white"})}),n.jsx("rect",{x:"9",y:"9",width:"24",height:"24",rx:"5",fill:"#CBB1FF"}),n.jsx("path",{d:"M17.8789 21.2613C18.4756 20.59 19.5244 20.59 20.1211 21.2613L25.5206 27.3356C26.0938 27.9805 25.636 29 24.7732 29H13.2268C12.364 29 11.9062 27.9805 12.4794 27.3356L17.8789 21.2613Z",fill:"white"}),n.jsx("path",{opacity:"0.5",d:"M23.4008 23.1837C23.9943 22.5446 25.0057 22.5446 25.5992 23.1837L29.4396 27.3195C30.0337 27.9594 29.58 29 28.7068 29H20.2932C19.42 29 18.9663 27.9594 19.5604 27.3195L23.4008 23.1837Z",fill:"white"}),n.jsx("circle",{cx:"26",cy:"16",r:"2",fill:"white"}),n.jsx("defs",{children:n.jsxs("filter",{id:"filter0_d_3295_43268",x:"3.5",y:"3.5",width:"35.5",height:"36",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[n.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),n.jsx("feOffset",{dy:"0.5"}),n.jsx("feGaussianBlur",{stdDeviation:"1.5"}),n.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),n.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),n.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3295_43268"}),n.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3295_43268",result:"shape"})]})})]})}];A(({store:e,imageMattingText:a})=>{const i=$(()=>({isChange:!1}));function r(){e.loadInfo.isRightTabLoading||(e.loadInfo.isRightTabLoading=!0,setTimeout(async()=>{await gt(e),e.stepStore.record("ImageMattingEdgeUpdated"),e.loadInfo.isRightTabLoading=!1}))}function o(){r(),i.isChange=!1}return n.jsxs("div",{className:F.Stroke,children:[n.jsx($e,{hidden:e.savedState.mattingDesign.strokeConfig.hidden,title:a(t=>t.mattingRightPanel.edgeSetting.strokes),iconName:"BorderBold",onChange:t=>{Ai(e,t),kt(e,"#232323"),Dt(e,1),et(e,.1),jt(e,1),r()}}),n.jsxs("div",{style:{paddingTop:"12px",display:e.savedState.mattingDesign.strokeConfig.hidden?"none":"block"},children:[n.jsxs("div",{className:F.colorBox,children:[n.jsx(ft,{value:e.savedState.mattingDesign.strokeConfig.color,onChange:t=>{kt(e,t),r()},onAfterChange:()=>{}}),n.jsx("div",{className:F.colorDegree,children:n.jsx(ae,{addonAfter:n.jsx("div",{children:"%"}),min:0,max:100,controls:!1,bordered:!1,value:Math.round(e.savedState.mattingDesign.strokeConfig.opacity*100),className:"addonAfter small",onChange:t=>{typeof t=="number"&&(i.isChange=!0,Dt(e,t/100))},onPressEnter:()=>{o()},onBlur:()=>{i.isChange&&o()}})})]}),n.jsx("div",{className:e.savedState.mattingDesign.strokeConfig.style===4?F.disable:"",children:n.jsx(xe,{store:e,value:Math.round(e.savedState.mattingDesign.strokeConfig.size*100),title:a(t=>t.mattingRightPanel.edgeSetting.size),onChange:t=>{et(e,t/100)},onAfterChange:t=>{r()}})}),n.jsx("div",{className:F.styleTitle,children:a(t=>t.mattingRightPanel.edgeSetting.style)}),n.jsx("div",{className:F.styleBox,children:yr.map(t=>n.jsx("div",{className:`${F.styleContent} ${e.savedState.mattingDesign.strokeConfig.style===t.style?F.styleActive:""}`,onClick:()=>{jt(e,t.style),et(e,t.style===4?0:.1),r()},children:e.savedState.mattingDesign.strokeConfig.style===t.style?t.activeIcon:t.icon},t.style))})]})]})});const Sr=A(({store:e,imageMattingText:a})=>{function i(){e.loadInfo.isRightTabLoading||(e.loadInfo.isRightTabLoading=!0,setTimeout(async()=>{await Fi(e,e.localStore),e.stepStore.record("ImageMattingEdgeUpdated"),e.loadInfo.isRightTabLoading=!1}))}return n.jsxs("div",{children:[n.jsx($e,{hidden:e.savedState.mattingDesign.blurConfig.hidden,title:a(r=>r.mattingRightPanel.edgeSetting.edgeSoftening),iconName:"BlurBold",onChange:r=>{Di(e,r),xt(e,r?0:2),i()}}),n.jsx("div",{style:{paddingTop:"9px",display:e.savedState.mattingDesign.blurConfig.hidden?"none":"block"},children:n.jsx(xe,{store:e,value:e.savedState.mattingDesign.blurConfig.value,title:a(r=>r.mattingRightPanel.edgeSetting.size),onChange:r=>{xt(e,r)},onAfterChange:r=>{i()}})})]})}),xr=A(({store:e,imageMattingText:a})=>{const i=$(()=>({isChange:!1}));function r(){e.loadInfo.isRightTabLoading||(e.loadInfo.isRightTabLoading=!0,setTimeout(async()=>{await gt(e),e.stepStore.record("ImageMattingEdgeUpdated"),e.loadInfo.isRightTabLoading=!1}))}function o(){r(),i.isChange=!1}return n.jsxs("div",{children:[n.jsx($e,{hidden:e.savedState.mattingDesign.glowConfig.hidden,title:a(t=>t.mattingRightPanel.edgeSetting.outerGlow),iconName:"ContourBold",onChange:t=>{Ri(e,t),It(e,"#FFF59E"),At(e,1),Rt(e,.1),r()}}),n.jsxs("div",{style:{paddingTop:"12px",display:e.savedState.mattingDesign.glowConfig.hidden?"none":"block"},children:[n.jsxs("div",{className:F.colorBox,children:[n.jsx(ft,{value:e.savedState.mattingDesign.glowConfig.color,onChange:t=>{It(e,t),r()},onAfterChange:()=>{}}),n.jsx("div",{className:F.colorDegree,children:n.jsx(ae,{addonAfter:n.jsx("div",{children:"%"}),min:0,max:100,controls:!1,bordered:!1,value:Math.round(e.savedState.mattingDesign.glowConfig.opacity*100),className:"addonAfter small",onChange:t=>{typeof t=="number"&&(i.isChange=!0,At(e,t/100))},onPressEnter:()=>{o()},onBlur:()=>{i.isChange&&o()}})})]}),n.jsx(xe,{store:e,value:Math.round(e.savedState.mattingDesign.glowConfig.blur*100),title:a(t=>t.mattingRightPanel.edgeSetting.range),onChange:t=>{Rt(e,t/100)},onAfterChange:t=>{r()}})]})]})});function wr({store:e,imageMattingText:a}){return n.jsx("div",{className:F.EdgeSetting,style:{height:"100%"},children:n.jsx(Oe.Scrollbars,{children:n.jsxs("div",{style:{padding:"12px 16px"},children:[n.jsx(vr,{store:e,imageMattingText:a}),n.jsx("div",{className:F.line}),null,n.jsx(Sr,{store:e,imageMattingText:a}),n.jsx("div",{className:F.line}),n.jsx(xr,{store:e,imageMattingText:a}),n.jsx("div",{className:F.line})]})})})}const br=A(wr);function ya({onDrop:e,onPaste:a,onPointerUp:i,style:r,children:o}){const t=X.useRef({onPaste:void 0});t.current.onPaste=a;async function c(m,v){return new Promise((w,k)=>{if(m==="text/plain"&&v.getAsString(async I=>{try{const D=await $a(I);if(D){const T=Yt(D,"name");w(T)}else k()}catch(D){throw console.log(D),D}}),m==="Files"&&v){const I=v.getAsFile();I&&w(I)}})}async function g(m){if(t.current.onPaste&&m.clipboardData){const v=m.clipboardData.types,w=[];for(let k=0;k<v.length;k+=1){const I=m.clipboardData.items[k],D=v[k];try{const T=await c(D,I);if(T)w.push(T);else throw new Error("url转base64失败，图片加载失败")}catch(T){throw console.log(T),T}}w.length>0&&t.current.onPaste(w,v)}}return X.useEffect(()=>(window.addEventListener("paste",g),()=>{window.removeEventListener("paste",g)}),[]),n.jsx("div",{className:"DropArea",style:r,onDragOver:m=>{m.preventDefault()},onDrop:m=>{m.preventDefault(),e==null||e(m.dataTransfer.files,m)},children:o})}ya.defaultProps={onDrop(){},onPointerUp(){},onPaste(){},style:{}};function Cr({store:e,imageMattingText:a}){const i=$(()=>({draging:!1}));return n.jsx("div",{style:{height:"100%"},children:n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:n.jsx(ya,{onDrop:async r=>{e.statsLogInfo.way="drag",at({store:e,imageMattingText:a,fileList:r,uploadFinishHandler:()=>{}})},onPaste:async(r,o)=>{if(o){const t=o[0];e.statsLogInfo.way=t==="text/plain"?"paste_url":"paste_photo"}at({store:e,imageMattingText:a,fileList:r,uploadFinishHandler:()=>{}})},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:600,height:360,border:"2px dashed black",borderRadius:12},onDragEnter:()=>{i.draging=!0},onDragLeave:()=>{i.draging=!1},onClick:async()=>{e.statsLogInfo.way="upload_button",at({store:e,imageMattingText:a,uploadFinishHandler:()=>{}})},children:[n.jsx("div",{draggable:!1,children:n.jsx(Za,{children:n.jsx("span",{style:{marginLeft:"5px"},children:a(r=>r.uploadImageSection.uploadBtn)})})}),n.jsx("div",{draggable:!1,style:{marginBottom:8,fontSize:14,lineHeight:"20px"},children:a(r=>r.uploadImageSection.uploadTip)}),n.jsx("div",{draggable:!1,onDragEnter:()=>{i.draging=!0},onDragLeave:()=>{i.draging=!0},children:n.jsx(ne,{hover:{color:"red",cursor:"pointer"},children:a(r=>r.uploadImageSection.supportFormart)})})]})})})})}const Lr=A(Cr),Tr=A(({store:e,toolsContainer:a,borderRadiusPercent:i,dragImageContainer:r})=>{const{localStore:o}=e,t=o.props.getPageSize(),c=o.getPageScale();return n.jsxs("div",{style:{position:"relative",width:t.width*c,height:t.height*c},children:[n.jsx("div",{className:"PageView",style:{position:"relative",transform:`scale(${c})`,transformOrigin:"0 0",width:t.width,height:t.height},onPointerDown:g=>{g.button===2&&g.stopPropagation()},children:n.jsx("div",{style:{position:"relative",width:t.width,height:t.height,boxSizing:"border-box"},children:n.jsx("div",{className:"normalLayerListView",style:{position:"absolute",left:0,top:0},children:n.jsx(Vt,{layer:e.page.originalImageLayer,localStore:o})})})}),a]})}),Nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2P8+vXrfwY84OPHL/ikGRhHDRgWYfDs2Uu86YCfnwd/Ohg1gIFx6IcBAPTPVKHaYv7lAAAAAElFTkSuQmCC",kr=A(({store:e,toolsContainer:a})=>{const{localStore:i}=e,r=i.props.getPageSize(),o=i.getPageScale(),t=i.props.getBackgroundLayer();return n.jsxs("div",{style:{position:"relative",width:r.width*o,height:r.height*o},children:[n.jsxs(ne,{vShow:e.rightTab==="size",children:[n.jsx("div",{style:{position:"absolute",left:e.savedState.pageFrame.left*o,top:e.savedState.pageFrame.top*o,width:e.savedState.pageFrame.width*o,height:e.savedState.pageFrame.height*o,backgroundImage:`url(${Nt})`,backgroundRepeat:"repeat"}}),n.jsx("div",{style:{position:"absolute",transform:`scale(${o})`,transformOrigin:"0 0",left:0,top:0,width:r.width,height:r.height},children:n.jsxs("div",{style:{position:"relative",width:r.width,height:r.height},children:[n.jsx(Je,{localStore:i,container:e.savedState.pageFrame,borderRadiusPercent:0}),e.rightTab==="size"?n.jsx(Je,{localStore:i,container:e.savedState.outputCandidateLayer,borderRadiusPercent:0}):null]})})]}),n.jsx(ne,{vShow:e.rightTab!=="size",style:{backgroundImage:`url(${Nt})`,backgroundRepeat:"repeat",width:"100%",height:"100%"},children:n.jsx("div",{className:"PageView",style:{position:"relative",overflow:"hidden",transform:`scale(${o})`,transformOrigin:"0 0",width:r.width,height:r.height},onPointerDown:c=>{c.button===2&&c.stopPropagation()},children:n.jsxs("div",{style:{position:"relative",width:r.width,height:r.height,boxSizing:"border-box"},children:[n.jsx("div",{style:{position:"relative",width:r.width,height:r.height},children:t?n.jsx(Je,{localStore:i,container:t,borderRadiusPercent:0}):null}),n.jsx("div",{className:"normalLayerListView",style:{position:"absolute",left:0,top:0},children:i.leafNormalLayerList.map(c=>n.jsx(Vt,{layer:c,localStore:i},c.id))})]})})}),a]})}),Dr="_inputNumberBox_4c42i_1",jr="_MattingLayerSetting_4c42i_6",Ir="_SizeSelect_4c42i_12",Ar="_sizeItemBox_4c42i_19",Rr="_sizeItem_4c42i_19",Er="_name_4c42i_32",_r="_activeSize_4c42i_39",Fr="_SizeInput_4c42i_43",Br="_icon_4c42i_48",Hr="_ScaleRotateSlider_4c42i_62",Pr="_sliderInput_4c42i_62",zr="_IconList_4c42i_74",Mr="_iconBox_4c42i_79",Nr="_BottomButton_4c42i_91",Ur="_button_4c42i_100",M={inputNumberBox:Dr,MattingLayerSetting:jr,SizeSelect:Ir,sizeItemBox:Ar,sizeItem:Rr,name:Er,activeSize:_r,SizeInput:Fr,icon:Br,ScaleRotateSlider:Hr,sliderInput:Pr,IconList:zr,iconBox:Mr,BottomButton:Nr,button:Ur},Wr=A(({store:e,updateDefaultSize:a,imageMattingText:i})=>{const r=$(()=>({sizeRatioList:[{id:"600101",name:i(o=>o.mattingRightPanel.mattingLayerSetting.originalSize),value:""},{id:"600102",name:i(o=>o.mattingRightPanel.mattingLayerSetting.free),value:"auto"},{id:"600103",name:i(o=>o.mattingRightPanel.mattingLayerSetting.cutoutEdge),value:"edge"},{id:"600104",name:"1:1",value:"1:1"},{id:"600105",name:"3:2",value:"3:2"},{id:"600106",name:"2:3",value:"2:3"},{id:"600107",name:"4:3",value:"4:3"},{id:"600108",name:"3:4",value:"3:4"},{id:"600109",name:"16:9",value:"16:9"},{id:"600110",name:"9:16",value:"9:16"}]}));return n.jsx("div",{className:M.SizeSelect,children:n.jsx(Oe.Scrollbars,{children:r.sizeRatioList.map(o=>n.jsx("div",{className:M.sizeItemBox,children:n.jsxs("div",{onClick:()=>{a(o.value)},className:`${M.sizeItem} ${e.savedState.mattingDesign.activeSize===o.value?M.activeSize:""}`,children:[n.jsx("div",{className:M.name,children:o.name}),e.savedState.mattingDesign.activeSize===o.value?n.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:n.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.156 2.58529C13.5001 2.92457 13.504 3.47858 13.1648 3.8227L5.97556 11.1144C5.80718 11.2851 5.57608 11.3793 5.33629 11.3749C5.09651 11.3705 4.86905 11.2678 4.7071 11.0909L0.812956 6.83743C0.486634 6.48099 0.511044 5.92751 0.867476 5.60119C1.22391 5.27487 1.77739 5.29928 2.10371 5.65571L5.37598 9.22992L11.9186 2.59405C12.2579 2.24993 12.8119 2.24601 13.156 2.58529Z"})}):null]})},o.value))})})}),Or=A(({store:e,updateInputSize:a,sizeIsLockedChanged:i,sizeData:r,imageMattingText:o})=>{const t=$(()=>({isChange:!1}));function c(){t.isChange=!1}return n.jsxs("div",{className:M.SizeInput,children:[n.jsx("div",{className:M.inputNumberBox,children:n.jsx(ae,{min:10,max:8e3,controls:!1,bordered:!1,addonAfter:n.jsxs("div",{children:["px ",o(g=>g.mattingRightPanel.mattingLayerSetting.width)]}),value:Math.round(r.width),className:"addonAfter",onBlur:()=>{c()},onChange:g=>{g&&(t.isChange=!0,a({width:g}))}})}),n.jsxs("div",{className:`${M.icon} plainButton`,onClick:()=>{i(!e.pageFrameFreeScaleVisible)},children:[n.jsx("div",{style:{width:"18px",height:"18px",display:e.pageFrameFreeScaleVisible?"none":"block"},children:"1"}),n.jsx("div",{style:{width:"18px",height:"18px",display:e.pageFrameFreeScaleVisible?"block":"none"},children:"1"})]}),n.jsx("div",{className:M.inputNumberBox,children:n.jsx(ae,{addonAfter:n.jsxs("div",{children:["px ",o(g=>g.mattingRightPanel.mattingLayerSetting.height)]}),value:Math.round(r.height),min:10,max:8e3,controls:!1,bordered:!1,className:"addonAfter",onBlur:()=>{c()},onChange:g=>{g&&(t.isChange=!0,a({height:g}))}})})]})}),Vr=A(({store:e,imageMattingText:a})=>{const i=$(()=>({isChange:!1}));return n.jsxs("div",{className:M.ScaleRotateSlider,style:{paddingBottom:"7px"},children:[n.jsxs("div",{className:M.sliderInput,children:[n.jsx("span",{children:a(r=>r.mattingRightPanel.mattingLayerSetting.scaleImage)}),n.jsx("div",{className:M.inputNumberBox,children:n.jsx(ae,{addonAfter:n.jsx("div",{children:"%"}),min:10,max:300,controls:!1,bordered:!1,value:Math.round(e.outputCandidateLayerScale*100),className:"addonAfter small",onBlur:()=>{i.isChange=!1},onChange:r=>{typeof r=="number"&&(lt(e,r/100),i.isChange=!0)}})})]}),n.jsx(je,{min:10,max:300,value:Math.round(e.outputCandidateLayerScale*100),tipFormatter:null,onAfterChange:()=>{i.isChange=!1},onChange:r=>{lt(e,r/100),i.isChange=!0}})]})}),Gr=A(({store:e,imageMattingText:a})=>{const i=$(()=>({isChange:!1}));return n.jsxs("div",{className:M.ScaleRotateSlider,style:{paddingBottom:"7px"},children:[n.jsxs("div",{className:M.sliderInput,children:[n.jsx("span",{children:a(r=>r.mattingRightPanel.mattingLayerSetting.rotateImage)}),n.jsx("div",{className:M.inputNumberBox,children:n.jsx(ae,{addonAfter:n.jsx("div",{children:"°"}),value:Math.round(e.savedState.outputCandidateLayer.rotate),className:"addonAfter small",min:-180,max:180,controls:!1,bordered:!1,onBlur:()=>{i.isChange=!1},onChange:r=>{typeof r=="number"&&(Ie(e,e.localStore,r),i.isChange=!0)}})})]}),n.jsx(je,{min:-180,max:180,value:Math.round(e.savedState.outputCandidateLayer.rotate),tipFormatter:null,onAfterChange:()=>{i.isChange=!1},onChange:r=>{Ie(e,e.localStore,Number(r)),i.isChange=!0}})]})}),Xr=A(({store:e})=>n.jsxs("div",{className:M.IconList,children:[n.jsx("div",{className:`${M.iconBox} plainButton`,onClick:()=>{Ie(e,e.localStore,e.savedState.outputCandidateLayer.rotate-90)},children:"1"}),n.jsx("div",{className:`${M.iconBox} plainButton`,onClick:()=>{Ie(e,e.localStore,e.savedState.outputCandidateLayer.rotate+90)},children:"1"}),n.jsx("div",{className:`${M.iconBox} plainButton`,onClick:()=>{e.savedState.outputCandidateLayer.image&&yt(e.localStore,e.savedState.outputCandidateLayer,"horizontally")},children:"1"}),n.jsx("div",{className:`${M.iconBox} plainButton`,onClick:()=>{e.savedState.outputCandidateLayer.image&&yt(e.localStore,e.savedState.outputCandidateLayer,"vertically")},children:"1"})]})),$r=A(({updateApplyList:e,cancelApplied:a,imageMattingText:i})=>n.jsxs("div",{className:M.BottomButton,children:[n.jsx("div",{className:`${M.button} plainButton`,onClick:()=>{a()},children:i(r=>r.mattingRightPanel.mattingLayerSetting.cancel)}),n.jsx("div",{className:`${M.button} primaryButton`,onClick:()=>{e()},children:i(r=>r.mattingRightPanel.mattingLayerSetting.apply)})]}));function Yr({store:e,imageMattingText:a}){const i=$(()=>({oldSize:"",applyList:[],oldTab:"",cursor:0,sizeData:{get width(){return e.savedState.pageFrame.width},get height(){return e.savedState.pageFrame.height}}}));X.useEffect(()=>{e.rightTab==="size"&&(i.applyList=[])},[e.rightTab]),X.useEffect(()=>{e.loadInfo.isGlobalLoading||e.rightTab==="size"&&ia(e)},[e.stepStore.stepCursor]),X.useEffect(()=>{e.loadInfo.isGlobalLoading||(Ji(e.savedState.pageFrame),["resizingPageFrameByBorder","resizingPageFrameByCorner"].includes(e.localStore.currentStatus)&&(Ki(e,8e3,8e3),["","edge"].includes(e.savedState.mattingDesign.activeSize)&&ye(e,"auto")))},[i.sizeData.width,i.sizeData.height]);function r(){oa(e)&&(na(e,e.localStore),i.applyList.push({activeSize:e.savedState.mattingDesign.activeSize,imageLayer:Q.cloneDeep(e.savedState.outputCandidateLayer),pageFrameLayer:Q.cloneDeep(e.savedState.pageFrame)}),i.cursor=i.applyList.length-2,e.savedState.statsLogOption.sizeCount+=1,e.stepStore.record("ScaledLayerImage"))}function o(){if(!e.savedState.outputCandidateLayer.image)return;const g=i.applyList[i.cursor];if(!g){t(""),e.savedState.outputCandidateLayer.image.flipV=!1,e.savedState.outputCandidateLayer.image.flipH=!1;return}i.cursor-=1,ye(e,g.activeSize),e.savedState.outputCandidateLayer=Q.cloneDeep(g.imageLayer),e.savedState.pageFrame=Q.cloneDeep(g.pageFrameLayer)}async function t(g){var T,E;if(!e.savedState.outputCandidateLayer.image)return;ye(e,g),tt(e,!0),i.oldSize="";let m=0,v=0,w=0,k=0;const{naturalWidth:I,naturalHeight:D}=e;if(g||(m=I,v=D,lt(e,1),Ie(e,e.localStore,0),w=(e.savedState.outputCandidateLayer.height-D)/2+e.savedState.outputCandidateLayer.top,k=(e.savedState.outputCandidateLayer.width-I)/2+e.savedState.outputCandidateLayer.left),g==="edge"){const{rotate:z}=e.savedState.outputCandidateLayer,B=await Ia(ut(e.savedState.outputCandidateLayer.image.imageSource),{rotate:z,flipV:(T=e.savedState.outputCandidateLayer.image)==null?void 0:T.flipV,flipH:(E=e.savedState.outputCandidateLayer.image)==null?void 0:E.flipH}),l=e.outputCandidateLayerScale;m=B.contentWidth*l,v=B.contentHeight*l,w=(e.savedState.outputCandidateLayer.height-B.frameSize*l)/2+B.top*l+e.savedState.outputCandidateLayer.top,k=(e.savedState.outputCandidateLayer.width-B.frameSize*l)/2+B.left*l+e.savedState.outputCandidateLayer.left}if(g.includes(":")){i.oldSize=g,tt(e,!1);const z=g.split(":"),B=Number(z[0]),l=Number(z[1]);B===l&&(m=I,v=I),B>l&&(m=I,v=I/(B/l)),B<l&&(m=B/l*D,v=D)}m&&v&&Ft(e,m,v,w,k)}function c({width:g,height:m}){let v=g||e.savedState.pageFrame.width,w=m||e.savedState.pageFrame.height;if(["","edge"].includes(e.savedState.mattingDesign.activeSize)&&ye(e,"auto"),e.pageFrameFreeScaleVisible&&(i.oldSize=""),!e.pageFrameFreeScaleVisible&&!(g&&m))if(e.savedState.mattingDesign.activeSize.includes(":")){const k=e.savedState.mattingDesign.activeSize.split(":"),I=Number(k[0]),D=Number(k[1]);g&&(w=D*g/I),m&&(v=I*m/D)}else{const k=e.savedState.pageFrame.width/e.savedState.pageFrame.height;g&&(w=g/k),m&&(v=m*k)}if(v>8e3){c({width:8e3});return}if(w>8e3){c({height:8e3});return}Ft(e,v,w)}return n.jsxs("div",{className:M.MattingLayerSetting,children:[n.jsx(Oe.Scrollbars,{children:n.jsxs("div",{style:{padding:"16px"},children:[n.jsx(Wr,{store:e,updateDefaultSize:g=>{t(g)},imageMattingText:a}),n.jsx(Or,{store:e,sizeIsLockedChanged:g=>{tt(e,g),i.oldSize&&(g?ye(e,"auto"):ye(e,i.oldSize))},updateInputSize:g=>{c(g)},sizeData:i.sizeData,imageMattingText:a}),n.jsx(Vr,{store:e,imageMattingText:a}),n.jsx(Gr,{store:e,imageMattingText:a}),n.jsx(Xr,{store:e})]})}),n.jsx($r,{updateApplyList:()=>{r()},cancelApplied:()=>{o()},imageMattingText:a})]})}const Zr=A(Yr);function qr(e,a){localStorage.setItem(e,a)}function Qr(e){return localStorage.getItem(e)}function Kr(e){return localStorage.removeItem(e)}const Jr={setItem:qr,getItem:Qr,removeItem:Kr};var eo=Object.defineProperty,to=Object.getOwnPropertyDescriptor,C=(e,a,i,r)=>{for(var o=r>1?void 0:r?to(a,i):a,t=e.length-1,c;t>=0;t--)(c=e[t])&&(o=(r?c(a,i,o):c(o))||o);return r&&o&&eo(a,i,o),o};wa({enforceActions:"never"});class b{constructor(){this.updateFilteredCanvas=Q.debounce(async()=>{if(this.page.originalImageLayer.image){this.filteredOriginCanvas.width=this.page.originalImageLayer.image.naturalWidth,this.filteredOriginCanvas.height=this.page.originalImageLayer.image.naturalHeight,Va(this.filteredOriginCanvas);const a=Aa(this.page.originalImageLayer),i=await Ya(a,this.filterConfig);this.filteredOriginCanvas=i}},2e3),this.initialized=!1,this.fringeExtraScale=1.4,this.maskCanvas=typeof document<"u"?document.createElement("canvas"):{},this.filteredOriginCanvas=typeof document<"u"?document.createElement("canvas"):{},this.leftStrokeCanvas=null,this.rightFragmentCanvas=null,this.currentStrokeCanvas=null,this.maskShapeCanvas=null,this.maskImageElement=typeof window<"u"?new Image:{},this.isRealtime=!1,this.state={blueColor:"#2195FF",redColor:"#FF5B4B",strokeType:"ERASE",areaColor:"#2195FF",strokeWidth:18,shadowBlur:100,pointerInBound:!1},this.savedState={mattingDesign:{mattingType:-1,useBlurFilterRun:!1,originalImageName:"",originalImageURL:"",imageResolvedMaskURL:"",imageBaseMaskURL:"",resultImageId:"",filterConfig:{groupId:"",id:"",zip:"",alpha:0},blurConfig:{value:0,hidden:!0},shadowConfig:{color:"",opacity:1,blur:0,x:0,y:0,hidden:!0},strokeConfig:{color:"",opacity:1,size:0,style:1,hidden:!0},glowConfig:{color:"",opacity:1,blur:0,hidden:!0},activeSize:"",page:{id:Ea(),width:0,height:0,backgroundLayer:pe(),originalImageLayer:pe(),normalLayerList:[]}},statsLogOption:{removeCount:0,retainCount:0,repairCount:0,sizeCount:0},materialMap:{background:"",filter:""},pageFrame:pe(),outputCandidateLayer:pe(),selectionInfo:Ra()},this.candidateRect=pe(),this.isInitedEffect=!1,this.iframeType="",this.internalRightTab="",this.leftTab="",this.isStrokeModeMoving=!1,this.pageFrameFreeScaleVisible=!0,this.filtersState={filterRecentUsedGroup:{},categoryCursor:""},this.loadInfo={isGlobalLoading:!1,isMattingLoading:!1,isRightTabLoading:!1,text:"",step:0,cancelInfo:{isCanceled:!1,onCancel:()=>{}}},this.feedbackVisible=!1,this.tipData={content:"",visible:!1,hasCancelButton:!0,confirmButtonText:"",cancelFunction:()=>{},confirmFunction:()=>{}},this.statsLogInfo={source:"other",way:"",original_size:""},this.purchaseInfo={isShowLetter:!1},this.chargeStatus=1,this.selectedRectId="",this.updateLoadInfo=a=>{Object.assign(this.loadInfo,a)},ba(this),this.stepStore=new _a(()=>this.savedState,100),this.localStore=ao(this),this.isRealtime&&(Be(()=>this.filterConfig.id,()=>{this.updateFilteredCanvas()}),Be(()=>this.filterConfig.alpha,()=>{this.updateFilteredCanvas()}),Be(()=>this.savedState.mattingDesign.originalImageURL,()=>{this.updateFilteredCanvas()})),Be(()=>{var a,i;return(i=(a=this.outputImageLayer)==null?void 0:a.image)==null?void 0:i.imageSource},()=>{this.isInitedEffect=!1})}get currentBackgroundId(){return""}initVerification(){this.chargeStatus=1}verificationDown(){this.chargeStatus=2}get isAllowDownload(){return!0}get statsLogOption(){return{...this.statsLogInfo,...this.savedState.statsLogOption}}get sodImageFeedBackVisible(){return this.feedbackVisible&&!Jr.getItem("showMattingFeedback")}get rightTab(){return this.internalRightTab}get filterConfig(){return this.savedState.mattingDesign.filterConfig}get filterCurrentId(){return`${this.filterConfig.groupId}${this.filterConfig.id}`}get filterAlphaPercent(){return this.filterConfig.alpha*100}get isStrokeMode(){return this.leftTab==="areaAdd"||this.leftTab==="areaDelete"||this.leftTab==="stroke"}get onlyRight(){return this.rightTab!==""}get strokeColor(){return this.state.strokeType==="BRUSH"?this.state.blueColor:this.state.redColor}get originalImageLayer(){return this.page.originalImageLayer}get rectMap(){var a;return(a=this.outputImageLayer)!=null&&a.extra.rectList?Q.keyBy(this.outputImageLayer.extra.rectList,"id"):{}}get selectedRect(){return this.rectMap[this.selectedRectId]||null}get originalImageLayerScale(){return this.page.originalImageLayer.image?this.page.originalImageLayer.width/this.page.originalImageLayer.image.naturalWidth:1}get outputCandidateLayerScale(){return this.savedState.outputCandidateLayer.image?this.savedState.outputCandidateLayer.width/this.savedState.outputCandidateLayer.image.naturalWidth:1}get outputImageLayerScale(){var a;return(a=this.outputImageLayer)!=null&&a.image?this.outputImageLayer.width/this.outputImageLayer.image.naturalWidth:1}get outputImageLayer(){return this.page.normalLayerList[0]}get naturalWidth(){var a;return((a=this.page.originalImageLayer.image)==null?void 0:a.naturalWidth)||0}get naturalHeight(){var a;return((a=this.page.originalImageLayer.image)==null?void 0:a.naturalHeight)||0}get page(){return this.savedState.mattingDesign.page}get resultImageCanvas(){if(this.page.normalLayerList[0]&&this.page.normalLayerList[0].image){const a=this.page.normalLayerList[0].image.imageSource;return ut(a)}return this.savedState.mattingDesign.originalImageURL}confirmModal(a,i){return this.tipData.visible=!0,this.tipData.content=a,this.tipData.confirmButtonText=(i==null?void 0:i.confirmButtonText)||"",this.tipData.hasCancelButton=(i==null?void 0:i.hasCancelButton)||!0,new Promise((r,o)=>{this.tipData.confirmFunction=()=>{r("success")},this.tipData.cancelFunction=o})}openPurchaseLetterModal(){this.purchaseInfo.isShowLetter=!0}closePurchaseLetterModal(){this.purchaseInfo.isShowLetter=!1}}C([V],b.prototype,"initialized",2);C([V],b.prototype,"isRealtime",2);C([V],b.prototype,"state",2);C([V],b.prototype,"savedState",2);C([V],b.prototype,"candidateRect",2);C([V],b.prototype,"isInitedEffect",2);C([V],b.prototype,"iframeType",2);C([V],b.prototype,"internalRightTab",2);C([V],b.prototype,"leftTab",2);C([V],b.prototype,"isStrokeModeMoving",2);C([V],b.prototype,"pageFrameFreeScaleVisible",2);C([N],b.prototype,"currentBackgroundId",1);C([V],b.prototype,"filtersState",2);C([V],b.prototype,"loadInfo",2);C([V],b.prototype,"feedbackVisible",2);C([V],b.prototype,"tipData",2);C([V],b.prototype,"statsLogInfo",2);C([V],b.prototype,"purchaseInfo",2);C([V],b.prototype,"chargeStatus",2);C([be],b.prototype,"initVerification",1);C([be],b.prototype,"verificationDown",1);C([N],b.prototype,"isAllowDownload",1);C([N],b.prototype,"statsLogOption",1);C([N],b.prototype,"sodImageFeedBackVisible",1);C([N],b.prototype,"rightTab",1);C([N],b.prototype,"filterConfig",1);C([N],b.prototype,"filterCurrentId",1);C([N],b.prototype,"filterAlphaPercent",1);C([N],b.prototype,"isStrokeMode",1);C([N],b.prototype,"onlyRight",1);C([N],b.prototype,"strokeColor",1);C([N],b.prototype,"originalImageLayer",1);C([N],b.prototype,"rectMap",1);C([V],b.prototype,"selectedRectId",2);C([N],b.prototype,"selectedRect",1);C([N],b.prototype,"originalImageLayerScale",1);C([N],b.prototype,"outputCandidateLayerScale",1);C([N],b.prototype,"outputImageLayerScale",1);C([N],b.prototype,"outputImageLayer",1);C([N],b.prototype,"naturalWidth",1);C([N],b.prototype,"naturalHeight",1);C([N],b.prototype,"page",1);C([N],b.prototype,"resultImageCanvas",1);C([be],b.prototype,"updateLoadInfo",2);C([be],b.prototype,"confirmModal",1);C([be],b.prototype,"openPurchaseLetterModal",1);C([be],b.prototype,"closePurchaseLetterModal",1);function ao(e){return new Fa({getNormalLayerList(){return e.page.normalLayerList},props:{getDocumentNode(){return null},getCurrentPage(){return null},getSelectionInfo(){return e.savedState.selectionInfo},getRootStore(){return{}},getPanelList(){return[]},getPageSize(){return{width:e.page.width,height:e.page.height}},getBackgroundLayer(){return e.page.backgroundLayer}}})}const io=A(({store:e})=>n.jsx(Gt,{stepStore:e.stepStore,localStore:e.localStore,polygonStore:null,customOverlays:n.jsx(Pi,{store:e,localStore:e.localStore}),menu:null})),no=A(({store:e,imageMattingText:a})=>n.jsx(Gt,{stepStore:e.stepStore,localStore:e.localStore,polygonStore:null,customOverlays:n.jsx(Ni,{store:e,localStore:e.localStore,imageMattingText:a}),menu:null})),ro=A(({store:e,imageMattingText:a})=>n.jsxs("div",{style:{height:"100%"},children:[n.jsx(ne,{style:{height:"100%"},vShow:e.rightTab==="size",children:n.jsx(Zr,{store:e,imageMattingText:a})}),n.jsx(ne,{style:{height:"100%"},vShow:e.rightTab==="edge",children:n.jsx(br,{store:e,imageMattingText:a})})]})),oo=A(({store:e,imageMattingStore:a})=>{const{localStore:i}=e,{imageMattingText:r}=a;return n.jsxs("div",{className:"--MattingApp",style:{width:"80vw",height:"80vh",background:"gray",overflow:"hidden"},children:[n.jsx(Ga,{localStore:i,stepStore:e.stepStore,polygonStore:null}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[n.jsx("div",{style:{width:"100%",borderBottom:"1px solid gray"},children:n.jsx("div",{style:{display:"flex"},children:n.jsx(gn,{store:e,localStore:i,imageMattingText:r})})}),n.jsx(ne,{vShow:!!e.savedState.mattingDesign.originalImageURL,style:{width:"100%",overflow:"hidden",flex:"1"},children:n.jsxs("div",{onContextMenu:o=>{o.preventDefault()},style:{width:"100%",height:"100%",display:"flex",overflow:"hidden"},children:[n.jsxs("div",{className:"leftWindow",style:{position:"relative",width:e.onlyRight?"0":"50%",height:"100%",transition:"width 0.3s"},onPointerMove:o=>{e.isStrokeMode&&i.currentStatus===""&&(e.state.pointerInBound=!0,Ba(i,o))},onPointerLeave:o=>{i.currentStatus!=="drawingMattingStrokePath"&&(e.state.pointerInBound=!1)},children:[n.jsx(vt,{className:"",localStore:i,children:n.jsx(Tr,{store:e,toolsContainer:n.jsx(io,{store:e}),borderRadiusPercent:0,dragImageContainer:null})}),n.jsx("div",{style:{position:"absolute",right:0,top:0,width:1,height:"100%",background:"var(--stroke--system-separator)"}}),n.jsx("div",{style:{position:"absolute",top:4,right:4,borderRadius:"4px",background:"var(--_base--black_opacity_30)",fontSize:"12px",fontWeight:"600",lineHeight:"17px",padding:"3px 8px",color:"var(--_base--white)"},children:r(o=>o.originalImage)})]}),n.jsx("div",{className:"rightWindow",style:{position:"relative",width:e.onlyRight?"100%":"50%",height:"100%"},children:n.jsxs("div",{style:{display:"flex",width:"100%",height:"100%"},children:[n.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[n.jsx("div",{style:{position:"absolute",left:0,top:0,width:1,height:"100%",background:"var(--stroke--system-separator)"}}),n.jsx(vt,{className:"RightWorkspace",isMainWorkspace:!0,localStore:i,children:n.jsx(kr,{store:e,toolsContainer:n.jsx(no,{store:e,imageMattingText:r}),imageMattingText:r})}),n.jsx("div",{style:{display:e.onlyRight?"none":"",position:"absolute",top:4,right:4,borderRadius:"4px",background:"var(--_base--black_opacity_30)",fontSize:"12px",fontWeight:"600",lineHeight:"17px",padding:"3px 8px",color:"var(--_base--white)"},children:r(o=>o.preview)})]}),n.jsx("div",{style:{display:e.onlyRight?"":"none",width:270,height:"100%",background:"white",borderLeft:"1px solid rgba(0, 0, 0, 0.08)"},children:n.jsx(ro,{store:e,imageMattingText:r})})]})})]})}),!e.savedState.mattingDesign.originalImageURL&&e.loadInfo.step<1?n.jsx("div",{style:{width:"100%",overflow:"hidden",flex:"1"},children:n.jsx(Lr,{store:e,imageMattingText:r})}):null]})]})});function lo(){const e=X.useState(()=>new b)[0];async function a(){const t=sa();e.iframeType||(window.onbeforeunload=function(c){return c.returnValue=r(g=>g.warnTip),r(g=>g.warnTip)}),typeof t.mattingType<"u"&&(e.savedState.mattingDesign.mattingType=Number(t.mattingType)),e.statsLogInfo.source=t.entrance||t.from||"other",o(),e.initialized=!0}const i=ei(()=>new ui({getReactiveLang(){return"cn"}})),{imageMattingText:r}=i;X.useEffect(()=>{a()},[]),X.useEffect(()=>{ht(e)},[e.rightTab]);async function o(t){}return e.initialized===!1?null:n.jsx(oo,{store:e,imageMattingStore:i})}const so=A(lo);function bo(){return n.jsx(so,{})}export{bo as default};
