import{j as e,r as u}from"./index-BpkY95s5.js";import{d as s}from"./index-CsSXPTiX.js";import{l as c,i as h,s as j}from"./index-B3ckdOIJ.js";import{a6 as y,ak as d,A as L,al as v,T as m}from"./CommonWrapper-BX2t_Qx2.js";import{W as k,F as g}from"./index-DFjs964h.js";import{R as p,a as w}from"./index-jpWs7lsT.js";import{M as C}from"./Menu-CsSKvxoy.js";import"./index-CR4nQrc0.js";import"./uploadUtil-CtCHnhsg.js";import"./index-BQvFTeGZ.js";const x=s(({store:r})=>{const{localStore:a,stepStore:i,collageInfo:o}=r;return e.jsx(m,{stepStore:i,localStore:a,polygonStore:null,menu:e.jsx(C,{collageInfo:o,localStore:a,stepStore:i,layerImageCreate:()=>Promise.resolve()})})}),f=s(({shuffleImg:r,store:a})=>{const{localStore:i,stepStore:o}=a;u.useEffect(()=>{a.page.width=800,a.page.height=1200,a.page.backgroundLayer.extra.backgroundColor="#ffffff",a.initialized=!0},[]);function n(l){switch(l){case 0:return null;case 1:return e.jsx(v,{localStore:i,frameList:a.savedState.posterCollageInfo.pageList,overlay:e.jsx(m,{localStore:i,stepStore:o,polygonStore:null,menu:null})});case 2:return e.jsx(L,{localStore:i,className:"",children:e.jsx(d,{localStore:i,toolsContainer:e.jsx(x,{store:a}),watermarkView:null})});case 3:return e.jsx(k,{localStore:i,navigator:e.jsx(d,{localStore:i,toolsContainer:null,watermarkView:null}),shuffleImg:r,addOrReplacePanelImageToPage:t=>{w(a,i,t)},children:e.jsx(d,{localStore:i,toolsContainer:e.jsx(x,{store:a}),watermarkView:null})});default:return null}}return e.jsx(y,{style:{position:"relative",width:"100%",height:"100%"},localStore:i,stepStore:o,polygonStore:null,children:n(2)})}),I=s(({store:r})=>{const{localStore:a,stepStore:i,collageInfo:o}=r,n=()=>{if(r.imageLayerList.length<2)return;const l=c.shuffle(c.cloneDeep(r.imageLayerList));if(l[0].id===r.imageLayerList[0].id){const t=l.splice(0,1);l.push(t[0])}for(const t in l)r.imageLayerList[t]&&(r.imageLayerList[t].image=l[t].image,r.imageLayerList[t].extra.backgroundColor=l[t].extra.backgroundColor,h(r.imageLayerList[t]),j(a,r.imageLayerList[t]))};return e.jsxs("div",{style:{height:"100%",backgroundColor:"var(--background--main)",display:"flex"},children:[e.jsx("div",{style:{position:"fixed",right:0,top:0,zIndex:1e3},children:e.jsx(p,{localStore:a,stepStore:i,collageInfo:o})}),e.jsx("div",{style:{flexShrink:0},children:e.jsx(g,{type:"left",foldChanged:()=>{},children:e.jsx("div",{})})}),e.jsx("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:e.jsx(f,{shuffleImg:n,store:r})}),e.jsx("div",{style:{height:"100%",flexShrink:0},children:e.jsx(g,{type:"right",foldChanged:()=>{},children:e.jsx("div",{})})})]})}),A=s(({posterStore:r})=>{const{localStore:a,collageInfo:i,stepStore:o}=r;return a.isMobile?e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%"},children:[e.jsx(f,{shuffleImg:()=>{},store:r}),e.jsx("div",{style:{position:"fixed",right:0,top:0,zIndex:1e3},children:e.jsx(p,{localStore:a,stepStore:o,collageInfo:i})})]}):e.jsx(I,{store:r})});export{A as default};
