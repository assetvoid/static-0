import{e as L,o as M}from"./index-CsSXPTiX.js";import{l as O,aP as v}from"./index-2ixAXTu-.js";import"./index-BpkY95s5.js";var I={exports:{}};(function(s,a){(function(c){s.exports=c()})(function(c){var u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function f(o,i){var t=o[0],e=o[1],n=o[2],r=o[3];t+=(e&n|~e&r)+i[0]-680876936|0,t=(t<<7|t>>>25)+e|0,r+=(t&e|~t&n)+i[1]-389564586|0,r=(r<<12|r>>>20)+t|0,n+=(r&t|~r&e)+i[2]+606105819|0,n=(n<<17|n>>>15)+r|0,e+=(n&r|~n&t)+i[3]-1044525330|0,e=(e<<22|e>>>10)+n|0,t+=(e&n|~e&r)+i[4]-176418897|0,t=(t<<7|t>>>25)+e|0,r+=(t&e|~t&n)+i[5]+1200080426|0,r=(r<<12|r>>>20)+t|0,n+=(r&t|~r&e)+i[6]-1473231341|0,n=(n<<17|n>>>15)+r|0,e+=(n&r|~n&t)+i[7]-45705983|0,e=(e<<22|e>>>10)+n|0,t+=(e&n|~e&r)+i[8]+1770035416|0,t=(t<<7|t>>>25)+e|0,r+=(t&e|~t&n)+i[9]-1958414417|0,r=(r<<12|r>>>20)+t|0,n+=(r&t|~r&e)+i[10]-42063|0,n=(n<<17|n>>>15)+r|0,e+=(n&r|~n&t)+i[11]-1990404162|0,e=(e<<22|e>>>10)+n|0,t+=(e&n|~e&r)+i[12]+1804603682|0,t=(t<<7|t>>>25)+e|0,r+=(t&e|~t&n)+i[13]-40341101|0,r=(r<<12|r>>>20)+t|0,n+=(r&t|~r&e)+i[14]-1502002290|0,n=(n<<17|n>>>15)+r|0,e+=(n&r|~n&t)+i[15]+1236535329|0,e=(e<<22|e>>>10)+n|0,t+=(e&r|n&~r)+i[1]-165796510|0,t=(t<<5|t>>>27)+e|0,r+=(t&n|e&~n)+i[6]-1069501632|0,r=(r<<9|r>>>23)+t|0,n+=(r&e|t&~e)+i[11]+643717713|0,n=(n<<14|n>>>18)+r|0,e+=(n&t|r&~t)+i[0]-373897302|0,e=(e<<20|e>>>12)+n|0,t+=(e&r|n&~r)+i[5]-701558691|0,t=(t<<5|t>>>27)+e|0,r+=(t&n|e&~n)+i[10]+38016083|0,r=(r<<9|r>>>23)+t|0,n+=(r&e|t&~e)+i[15]-660478335|0,n=(n<<14|n>>>18)+r|0,e+=(n&t|r&~t)+i[4]-405537848|0,e=(e<<20|e>>>12)+n|0,t+=(e&r|n&~r)+i[9]+568446438|0,t=(t<<5|t>>>27)+e|0,r+=(t&n|e&~n)+i[14]-1019803690|0,r=(r<<9|r>>>23)+t|0,n+=(r&e|t&~e)+i[3]-187363961|0,n=(n<<14|n>>>18)+r|0,e+=(n&t|r&~t)+i[8]+1163531501|0,e=(e<<20|e>>>12)+n|0,t+=(e&r|n&~r)+i[13]-1444681467|0,t=(t<<5|t>>>27)+e|0,r+=(t&n|e&~n)+i[2]-51403784|0,r=(r<<9|r>>>23)+t|0,n+=(r&e|t&~e)+i[7]+1735328473|0,n=(n<<14|n>>>18)+r|0,e+=(n&t|r&~t)+i[12]-1926607734|0,e=(e<<20|e>>>12)+n|0,t+=(e^n^r)+i[5]-378558|0,t=(t<<4|t>>>28)+e|0,r+=(t^e^n)+i[8]-2022574463|0,r=(r<<11|r>>>21)+t|0,n+=(r^t^e)+i[11]+1839030562|0,n=(n<<16|n>>>16)+r|0,e+=(n^r^t)+i[14]-35309556|0,e=(e<<23|e>>>9)+n|0,t+=(e^n^r)+i[1]-1530992060|0,t=(t<<4|t>>>28)+e|0,r+=(t^e^n)+i[4]+1272893353|0,r=(r<<11|r>>>21)+t|0,n+=(r^t^e)+i[7]-155497632|0,n=(n<<16|n>>>16)+r|0,e+=(n^r^t)+i[10]-1094730640|0,e=(e<<23|e>>>9)+n|0,t+=(e^n^r)+i[13]+681279174|0,t=(t<<4|t>>>28)+e|0,r+=(t^e^n)+i[0]-358537222|0,r=(r<<11|r>>>21)+t|0,n+=(r^t^e)+i[3]-722521979|0,n=(n<<16|n>>>16)+r|0,e+=(n^r^t)+i[6]+76029189|0,e=(e<<23|e>>>9)+n|0,t+=(e^n^r)+i[9]-640364487|0,t=(t<<4|t>>>28)+e|0,r+=(t^e^n)+i[12]-421815835|0,r=(r<<11|r>>>21)+t|0,n+=(r^t^e)+i[15]+530742520|0,n=(n<<16|n>>>16)+r|0,e+=(n^r^t)+i[2]-995338651|0,e=(e<<23|e>>>9)+n|0,t+=(n^(e|~r))+i[0]-198630844|0,t=(t<<6|t>>>26)+e|0,r+=(e^(t|~n))+i[7]+1126891415|0,r=(r<<10|r>>>22)+t|0,n+=(t^(r|~e))+i[14]-1416354905|0,n=(n<<15|n>>>17)+r|0,e+=(r^(n|~t))+i[5]-57434055|0,e=(e<<21|e>>>11)+n|0,t+=(n^(e|~r))+i[12]+1700485571|0,t=(t<<6|t>>>26)+e|0,r+=(e^(t|~n))+i[3]-1894986606|0,r=(r<<10|r>>>22)+t|0,n+=(t^(r|~e))+i[10]-1051523|0,n=(n<<15|n>>>17)+r|0,e+=(r^(n|~t))+i[1]-2054922799|0,e=(e<<21|e>>>11)+n|0,t+=(n^(e|~r))+i[8]+1873313359|0,t=(t<<6|t>>>26)+e|0,r+=(e^(t|~n))+i[15]-30611744|0,r=(r<<10|r>>>22)+t|0,n+=(t^(r|~e))+i[6]-1560198380|0,n=(n<<15|n>>>17)+r|0,e+=(r^(n|~t))+i[13]+1309151649|0,e=(e<<21|e>>>11)+n|0,t+=(n^(e|~r))+i[4]-145523070|0,t=(t<<6|t>>>26)+e|0,r+=(e^(t|~n))+i[11]-1120210379|0,r=(r<<10|r>>>22)+t|0,n+=(t^(r|~e))+i[2]+718787259|0,n=(n<<15|n>>>17)+r|0,e+=(r^(n|~t))+i[9]-343485551|0,e=(e<<21|e>>>11)+n|0,o[0]=t+o[0]|0,o[1]=e+o[1]|0,o[2]=n+o[2]|0,o[3]=r+o[3]|0}function l(o){var i=[],t;for(t=0;t<64;t+=4)i[t>>2]=o.charCodeAt(t)+(o.charCodeAt(t+1)<<8)+(o.charCodeAt(t+2)<<16)+(o.charCodeAt(t+3)<<24);return i}function h(o){var i=[],t;for(t=0;t<64;t+=4)i[t>>2]=o[t]+(o[t+1]<<8)+(o[t+2]<<16)+(o[t+3]<<24);return i}function p(o){var i=o.length,t=[1732584193,-271733879,-1732584194,271733878],e,n,r,b,E,P;for(e=64;e<=i;e+=64)f(t,l(o.substring(e-64,e)));for(o=o.substring(e-64),n=o.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)r[e>>2]|=o.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(f(t,r),e=0;e<16;e+=1)r[e]=0;return b=i*8,b=b.toString(16).match(/(.*?)(.{0,8})$/),E=parseInt(b[2],16),P=parseInt(b[1],16)||0,r[14]=E,r[15]=P,f(t,r),t}function y(o){var i=o.length,t=[1732584193,-271733879,-1732584194,271733878],e,n,r,b,E,P;for(e=64;e<=i;e+=64)f(t,h(o.subarray(e-64,e)));for(o=e-64<i?o.subarray(e-64):new Uint8Array(0),n=o.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)r[e>>2]|=o[e]<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(f(t,r),e=0;e<16;e+=1)r[e]=0;return b=i*8,b=b.toString(16).match(/(.*?)(.{0,8})$/),E=parseInt(b[2],16),P=parseInt(b[1],16)||0,r[14]=E,r[15]=P,f(t,r),t}function x(o){var i="",t;for(t=0;t<4;t+=1)i+=u[o>>t*8+4&15]+u[o>>t*8&15];return i}function g(o){var i;for(i=0;i<o.length;i+=1)o[i]=x(o[i]);return o.join("")}g(p("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function o(i,t){return i=i|0||0,i<0?Math.max(i+t,0):Math.min(i,t)}ArrayBuffer.prototype.slice=function(i,t){var e=this.byteLength,n=o(i,e),r=e,b,E,P,F;return t!==c&&(r=o(t,e)),n>r?new ArrayBuffer(0):(b=r-n,E=new ArrayBuffer(b),P=new Uint8Array(E),F=new Uint8Array(this,n,b),P.set(F),E)}}();function A(o){return/[\u0080-\uFFFF]/.test(o)&&(o=unescape(encodeURIComponent(o))),o}function z(o,i){var t=o.length,e=new ArrayBuffer(t),n=new Uint8Array(e),r;for(r=0;r<t;r+=1)n[r]=o.charCodeAt(r);return i?n:e}function C(o){return String.fromCharCode.apply(null,new Uint8Array(o))}function w(o,i,t){var e=new Uint8Array(o.byteLength+i.byteLength);return e.set(new Uint8Array(o)),e.set(new Uint8Array(i),o.byteLength),e}function m(o){var i=[],t=o.length,e;for(e=0;e<t-1;e+=2)i.push(parseInt(o.substr(e,2),16));return String.fromCharCode.apply(String,i)}function d(){this.reset()}return d.prototype.append=function(o){return this.appendBinary(A(o)),this},d.prototype.appendBinary=function(o){this._buff+=o,this._length+=o.length;var i=this._buff.length,t;for(t=64;t<=i;t+=64)f(this._hash,l(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},d.prototype.end=function(o){var i=this._buff,t=i.length,e,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r;for(e=0;e<t;e+=1)n[e>>2]|=i.charCodeAt(e)<<(e%4<<3);return this._finish(n,t),r=g(this._hash),o&&(r=m(r)),this.reset(),r},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(o){return this._buff=o.buff,this._length=o.length,this._hash=o.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(o,i){var t=i,e,n,r;if(o[t>>2]|=128<<(t%4<<3),t>55)for(f(this._hash,o),t=0;t<16;t+=1)o[t]=0;e=this._length*8,e=e.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(e[2],16),r=parseInt(e[1],16)||0,o[14]=n,o[15]=r,f(this._hash,o)},d.hash=function(o,i){return d.hashBinary(A(o),i)},d.hashBinary=function(o,i){var t=p(o),e=g(t);return i?m(e):e},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(o){var i=w(this._buff.buffer,o),t=i.length,e;for(this._length+=o.byteLength,e=64;e<=t;e+=64)f(this._hash,h(i.subarray(e-64,e)));return this._buff=e-64<t?new Uint8Array(i.buffer.slice(e-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(o){var i=this._buff,t=i.length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n,r;for(n=0;n<t;n+=1)e[n>>2]|=i[n]<<(n%4<<3);return this._finish(e,t),r=g(this._hash),o&&(r=m(r)),this.reset(),r},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var o=d.prototype.getState.call(this);return o.buff=C(o.buff),o},d.ArrayBuffer.prototype.setState=function(o){return o.buff=z(o.buff,!0),d.prototype.setState.call(this,o)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(o,i){var t=y(new Uint8Array(o)),e=g(t);return i?m(e):e},d})})(I);async function T(){return{url:"http://n.sinaimg.cn/blog/700/w1000h500/20220325/c84d-a6a4ed629d39ec51d911d70498ccbdbd.jpg",name:"life"}}function re(s,a){return new Promise((c,u)=>{const f=new Image;f.setAttribute("crossOrigin","Anonymous");const l=document.createElement("canvas"),h=l.getContext("2d");f.onload=()=>{const{width:p,height:y}=f;l.height=y,l.width=p,h.drawImage(f,0,0,p,y),c(l.toDataURL("image/png"))},f.onerror=()=>{u(new Error("图片加载失败"))},f.src=s})}function ne(s,a){const c=s.split(","),u=c[0].match(/:(.*?);/)[1],f=u.split("/")[1],l=atob(c[1]);let h=l.length;const p=new Uint8Array(h);for(;h--;)p[h]=l.charCodeAt(h);return new File([p],`${a}.${f}`,{type:u})}function $(s){return new Promise(a=>{const c=new FileReader;c.onload=()=>{a(c.result)},c.readAsDataURL(s)})}function ie(s,a){const{type:c}=s;return new File([s],a,{type:c})}async function R(s){const a=await $(s);return new Promise(c=>{const u=new Image;u.onload=()=>{c(u)},u.onerror=()=>{c(u)},u.src=a})}function oe(s,a,c){return new Promise((u,f)=>{try{s.toBlob(l=>{l?u(l):f(l)},a,c)}catch(l){f(l)}})}var j=Object.defineProperty,D=(s,a,c,u)=>{for(var f=void 0,l=s.length-1,h;l>=0;l--)(h=s[l])&&(f=h(a,c,f)||f);return f&&j(a,c,f),f};typeof window>"u"&&L(!0);class B{constructor(a){this.currentResource=null,this.resourceMap=a.resourceMap}applyLang(a){this.resourceMap[a]&&(this.currentResource=O.cloneDeep(this.resourceMap[a]))}}D([M],B.prototype,"currentResource");function H(s){const a=new B(s);return a.applyLang(s.getReactiveLang()),c=>{if(a.currentResource)try{return c(a.currentResource)}catch(u){return typeof window<"u"&&console.error(u),""}return""}}const S={uploadingText:"图片上传中",messageError:{getCountAndSupportText(s,a){return`${s}张图片上传失败，暂时只支持${a}格式的图片`},getFormartText(s){return`暂时只支持${s}格式的图片`},maxNum:"最多允许同时上传20张图片",maxWidthAndHeight:"仅支持宽高均为8000px以内的图片",maxValueAndSize:"仅支持20M，宽高均为8000px以内的图片",formatImage:"张图片上传失败，暂时只支持JPG/JPEG/PNG格式的图片",multipleUploadFailed:"张图片上传失败，仅支持20M，宽高均为8000px以内的图片",imageUploadFaild:"图片上传失败"}},V=S,G=S,J=S,N=S;function K({getReactiveLang:s}){return H({resourceMap:{cn:S,jp:J,tw:V,kr:N,en:G},getReactiveLang:s})}const _=K({getReactiveLang(){return"cn"}}),W={1:"typeError",2:"sizeOfVolumeError",3:"sizeOfAreaError"};async function se(s){return s.fileList?U(Array.from(s.fileList),s):new Promise((a,c)=>{var f;(f=s.mattingMonitor)==null||f.startStage("SelectingImages");const u=document.createElement("input");u.style.display="none",document.body.appendChild(u),u.type="file",u.accept=s.accept.join(","),u.multiple=s.multiple,u.click(),u.onchange=async l=>{var p,y,x;(p=s.mattingMonitor)==null||p.finishStage("SelectingImages"),(y=s.mattingMonitor)==null||y.startStage("Matting"),(x=s.mattingMonitor)==null||x.startStage("上传图片 uploading");const h=l.target;if(h&&h.files){const{files:g}=h;await U(Array.from(g),s).then(A=>{a(A)}).catch(A=>{c(A)})}else c();document.body.removeChild(u)}})}async function ae(s){return new Promise((a,c)=>{const u=document.createElement("input");u.style.display="none",document.body.appendChild(u),u.type="file",u.accept=s.accept.join(","),u.multiple=s.multiple,u.click(),u.onchange=async f=>{const l=f.target;l&&l.files?a({fileList:l.files}):c(),document.body.removeChild(u)}})}async function U(s,a){var p,y,x;(p=a.mattingMonitor)==null||p.startStage("校验图片文件 validateImageFiles");const c=await q(s,a);(y=a.mattingMonitor)==null||y.finishStage("校验图片文件 validateImageFiles");let u;a.showProgress&&(u=Z(a.cancelInfo,a.progressColor));const{list:f,errorInfo:l}=c;let h=[];try{return h=await Y(f,l,a),u&&!((x=a.cancelInfo)!=null&&x.isCanceled)&&document.body.removeChild(u),h.length>0?await Promise.resolve(h):await Promise.reject(new Error("上传过程中取消了上传"))}catch(g){return u&&document.body.removeChild(u),Promise.reject(g)}}async function q(s,a){const{multiple:c,beforeUpload:u,maxCount:f,accept:l}=a;let h=[];c?h=[...s]:h=[s[0]];try{u&&await u(h)}catch(w){throw console.log("取消上传"),w}const p=[],{length:y}=h;if(y>20&&!a.messageHidden){const w=_(m=>m.messageError.maxNum);v.info(w)}const x=f&&f<20?f:20;x&&y>x&&h.splice(x);const g={typeError:0,sizeOfVolumeError:0,sizeOfAreaError:0},A=[];h.forEach(async w=>{A.push(Q(w,a))}),(await Promise.all(A)).forEach(w=>{if(w.code==="0")p.push(w.file);else{const m=W[w.code];g[m]+=1}});let C="";if(!p.length){const w=l.join("/").replace(/image\//g,"").toUpperCase();if(y>1){if(g.typeError&&(a.messageHidden||v.error(_(m=>m.messageError.getCountAndSupportText(g.typeError,w))),C=`${g.typeError} file is not JPG/JPEG/PNG`),g.sizeOfAreaError+g.sizeOfVolumeError>0){if(!a.messageHidden){const m=_(d=>d.messageError.multipleUploadFailed);v.error(`${g.sizeOfAreaError+g.sizeOfVolumeError}${m}`)}C=`${g.sizeOfAreaError+g.sizeOfVolumeError} file size exceeds 20M or 8000px`}}else{if(g.typeError&&(a.messageHidden||v.error(_(m=>m.messageError.getFormartText(w))),C="file is not JPG/JPEG/PNG"),g.sizeOfAreaError){if(!a.messageHidden){const m=_(d=>d.messageError.maxWidthAndHeight);v.error(m)}C="file size exceeds 8000px"}if(g.sizeOfVolumeError){if(!a.messageHidden){const m=_(d=>d.messageError.maxValueAndSize);v.error(m)}C="file size exceeds 20M"}}return Promise.reject(new Error(C))}return Promise.resolve({list:p,errorInfo:g})}async function Q(s,a){const{accept:c=["image/jpeg","image/jpg","image/png"],maxFileSize:u=20}=a;if(!(s.type&&c.includes(s.type)||!1))return Promise.resolve({code:"1",file:s});if(!(s.size/1024/1024<u))return Promise.resolve({code:"2",file:s});const h=await R(s);return h.width<=8e3&&h.height<=8e3?Promise.resolve({code:"0",file:s}):Promise.resolve({code:"3",file:s})}async function X(s,a){var u,f;if((u=a.cancelInfo)!=null&&u.isCanceled)return Promise.resolve({url:"",name:"",size:0,width:0,height:0});let c;try{c=await T()}catch(l){throw new Error(`${l.message||l} 图片上传失败`)}return c?(f=a.cancelInfo)!=null&&f.isCanceled?Promise.resolve({url:"",name:"",size:0,width:0,height:0}):new Promise(l=>{const h=new Image;h.onload=()=>{var y;(y=a.cancelInfo)!=null&&y.isCanceled&&l({url:"",name:"",size:0,width:0,height:0});const p={url:(c==null?void 0:c.url)||"",name:(c==null?void 0:c.name)||"",size:s.size,width:h.width,height:h.height};l(p)},h.onerror=()=>{l({url:"",name:"",size:0,width:0,height:0})},h.src=(c==null?void 0:c.url)||""}):Promise.resolve({url:"",name:"",size:0,width:0,height:0})}async function Y(s,a,c){const u=[];return s.forEach(f=>{u.push(X(f,c))}),Promise.all(u).then(f=>{var h;if(!((h=c.cancelInfo)!=null&&h.isCanceled)){if(a.typeError&&!c.messageHidden){const p=_(y=>y.messageError.formatImage);v.error(`${a.typeError}${p}`)}if(a.sizeOfAreaError+a.sizeOfVolumeError>0&&!c.messageHidden){const p=_(y=>y.messageError.multipleUploadFailed);v.error(`${a.sizeOfAreaError+a.sizeOfVolumeError}${p}`)}}const l=[];return f.forEach(p=>{p.url&&l.push(p)}),l}).catch(f=>{const l=_(h=>h.messageError.imageUploadFaild);throw v.error(l),f})}function Z(s,a){const c=document.createElement("div");c.style.cssText="position: fixed; z-index: 100000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); display: flex;",c.innerHTML=` <div style="width: 320px; margin: auto; border-radius: 12px; display: flex; flex-direction: column; align-items: center; padding: 24px 70px 30px; background: #fff; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.08), 0px 24px 128px rgba(0, 0, 0, 0.16);">
  <div style="font-size: 16px; font-weight: 600; line-height: 22px; color: #1C1D1F; margin-bottom: 20px;">图片上传中</div>
  <div style="position: relative; width: 256px; height: 4px; border-radius: 2px; background: #EBEDF2;">
    <div class='progrees-slider'  style="position: absolute; transition: all 5s linear; left: 0; top: 0; height: 4px; border-radius: 2px; background: ${a||"#66A8FF"}; width: 0;"></div>
  </div>
  <div class='progrees-cancel-button' style="width: 100px; height: 32px; margin-top: 24px; color: #1C1D1F; line-height: 32px; text-align: center; border-radius: 8px; border: 1px solid #D0D2D6; cursor: pointer">取消</div>
</div>`,document.body.appendChild(c);const u=document.getElementsByClassName("progrees-cancel-button"),f=document.getElementsByClassName("progrees-slider");return setTimeout(()=>{f[0]&&(f[0].style.width="95%")},10),u[0].onclick=()=>{s&&(s.onCancel&&s.onCancel(),s.isCanceled=!0),document.body.removeChild(c)},c}export{K as a,ne as b,H as c,ae as d,oe as e,ie as f,T as g,se as t,re as u};
